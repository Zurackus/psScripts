"Selected","Severity","DisplayName","Kind","Name","Description","RequiredDataConnectors","RuleFrequency","RulePeriod","RuleFrequency2","Version","Status"
" ","High","TEARDROP memory-only dropper","Scheduled","738702fd-0a66-42c7-8586-e30f0583f8fe","Identifies SolarWinds TEARDROP memory-only dropper IOCs in Window's defender Exploit Guard activity
References:
- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f","MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","High","Exchange SSRF Autodiscover ProxyShell - Detection","Scheduled","968358d6-6af8-49bb-aaa4-187b3067fb95","This query looks for suspicious request patterns to Exchange servers that fit patterns recently
blogged about by PeterJson. This exploitation chain utilises an SSRF vulnerability in Exchange
which eventually allows the attacker to execute arbitrary Powershell on the server. In the example
powershell can be used to write an email to disk with an encoded attachment containing a shell.
Reference: https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1","AzureMonitor(IIS)","Every 12 hours","Last 12 hours","",,"Available"
" ","Medium","TI map IP entity to DnsEvents","Scheduled","69b7723c-2889-469f-8b55-a2d355ed9c87","Identifies a match in DnsEvents from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|DNS","Every 1 hour","Last 14 days","",,"Available"
" ","Low","Login to AWS Management Console without MFA","Scheduled","d25b1998-a592-4bc5-8a3a-92b39eedb1bc","Multi-Factor Authentication (MFA) helps you to prevent credential compromise. This alert identifies logins to the AWS Management Console without MFA.
You can limit this detection to trigger for adminsitrative accounts if you do not have MFA enabled on all accounts.
This is done by looking at the eventName ConsoleLogin and if the AdditionalEventData field indicates MFA was NOT used 
and the ResponseElements field indicates NOT a Failure. Thereby indicating that a non-MFA login was successful.","AWS","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Vectra AI Detect - Suspected Compromised Account","Scheduled","321f9dbd-64b7-4541-81dc-08cf7732ccb0","Create an incident when an Account is suspected to be compromised. 
The higher the severity level is, the more immediate attention it requires as Vectra AI engine is more confident that this is a real threat. 
Level of severity are: Low, Medium, High, Critical). Recommended configuration is to trigger an alert for at least High and Critical.","AIVectraDetect","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Failed Logins from Unknown or Invalid User","Scheduled","884be6e7-e568-418e-9c12-89229865ffde","This query searches for numerous login attempts to the management console with an unknown or invalid user name","OktaSSO","Every 1 hour","Last 1 hour","",,"Available"
" ","Informational","(Preview) Unusual external firewall alarm detected","Anomaly","213252f1-497c-4124-91da-6cb43902d5b1","This algorithm identifies unusual external firewall alarms which are threat signatures released by a firewall vendor. 
The anomaly takes last 7 days activities to calculate top 10 noisy signatures and also noisy source hosts which are repeatedly seen 
triggering threat signatures. After excluding both type of noisy events, it triggers an anomaly only after exceeding the threshold of 
number of signatures triggered in a single day.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Medium","Detect PIM Alert Disabling activity","Scheduled","1f3b4dfd-21ff-4ed3-8e27-afc219e05c50","Privileged Identity Management (PIM) generates alerts when there is suspicious or unsafe activity in Azure Active Directory (Azure AD) organization. 
This query will help detect attackers attempts to disable in product PIM alerts which are associated with Azure MFA requirements and could indicate activation of privileged access","AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Low","ProofpointPOD - Weak ciphers","Scheduled","56b0a0cd-894e-4b38-a0a1-c41d9f96649a","Detects when weak TLS ciphers are used.","ProofpointPOD","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","External User Access Enabled","Scheduled","8e267e91-6bda-4b3c-bf68-9f5cbdd103a3","This alerts when the account setting is changed to allow either external domain access or anonymous access to meetings.","","Every 1 day","Last 1 day","",,"Available"
" ","High","Alsid Password Guessing","Scheduled","ba239935-42c2-472d-80ba-689186099ea1","Searches for bruteforce Password Guessing attacks","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","High","User login from different countries within 3 hours (Uses Authentication Normalization)","Scheduled","09ec8fa2-b25f-4696-bfae-05a7b85d7b9e","This query searches for successful user logins from different countries within 3 hours.
 To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelAuthentication)","","Every 3 hours","Last 3 hours","",,"Available"
" ","Informational","(Preview) Anomalous Sign In","Anomaly","bb32dc8a-4f6b-4274-a28f-50f3400070b4","Adversaries may steal the credentials of a specific user or service account using Credential
Access techniques or capture credentials earlier in their reconnaissance process through
social engineering for means of gaining Persistence. Sentinel UEBA detects anomalies based on dynamic baselines created for each entity across various data inputs. Each entityâ€™s baseline behavior is set according to its own historical activities, those of its peers, and those of the organization as a whole. Anomalies can be triggered by the correlation of different attributes such as action type, geo-location, device, resource, ISP, and more.","AzureActiveDirectory|SecurityEvents","","","Every 1 day",,"Available"
" ","Medium","High count of failed logons by a user","Scheduled","884c4957-70ea-4f57-80b9-1bca3890315b","Identifies when 100 or more failed attempts by a given user in 10 minutes occur on the IIS Server.
This could be indicative of attempted brute force based on known account information.
This could also simply indicate a misconfigured service or device. 
References:
IIS status code mapping - https://support.microsoft.com/help/943891/the-http-status-code-in-iis-7-0-iis-7-5-and-iis-8-0
Win32 Status code mapping - https://msdn.microsoft.com/library/cc231199.aspx","AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","Medium","ProofpointPOD - Email sender IP in TI list","Scheduled","78979d32-e63f-4740-b206-cfb300c735e0","Email sender IP in TI list.","ThreatIntelligence|ThreatIntelligenceTaxii|ProofpointPOD","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Brute force attack against Azure Portal","Scheduled","28b42356-45af-40a6-a0b4-a554cdfd5d8a","Identifies evidence of brute force activity against Azure Portal by highlighting multiple authentication failures 
and by a successful authentication within a given time window. 
(The query does not enforce any sequence - eg requiring the successful authentication to occur last.)
Default Failure count is 5, Default Success count is 1 and default Time Window is 20 minutes.
References: https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","High","Authentication Methods Changed for Privileged Account","Scheduled","694c91ee-d606-4ba9-928e-405a2dd0ff0f","Identifies authentication methods being changed for a privileged account. This could be an indicated of an attacker adding an auth method to the account so they can have continued access.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor-1","AzureActiveDirectory","Every 2 hours","Last 14 days","",,"Available"
" ","Informational","(Preview) Unusual network communication on commonly used ports","Anomaly","ae9128e8-2740-4b62-8bde-54e62b183fca","This algorithm identifies unusual network communication on commonly used ports, comparing daily traffic to a baseline from the previous 7 days.
This includes traffic on commonly used ports (22, 53, 80, 443, 8080, 8888), and compares daily traffic to the mean and standard deviation of several
network traffic attributes calculated over the baseline period. The traffic attributes considered are daily total events, daily data transfer and 
number of distinct destination IP addresses per port. An anomaly is triggered when the daily values are greater than the configured number of standard deviations above the mean.","PaloAltoNetworks|CheckPoint|Fortinet","","","Every 1 day",,"Available"
" ","Medium","ProofpointPOD - Email sender in TI list","Scheduled","35a0792a-1269-431e-ac93-7ae2980d4dde","Email sender in TI list.","ThreatIntelligence|ThreatIntelligenceTaxii|ProofpointPOD","Every 1 day","Last 14 days","",,"Available"
" ","High","SUNBURST and SUPERNOVA backdoor hashes (Normalized File Events)","Scheduled","bc5ffe2a-84d6-48fe-bc7b-1055100469bc","Identifies SolarWinds SUNBURST and SUPERNOVA backdoor file hash IOCs in File Events
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelFileEvent)
References:
- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f","","Every 1 day","Last 1 day","",,"Available"
" ","Low","AD user enabled and password not set within 48 hours","Scheduled","62085097-d113-459f-9ea7-30216f2ee6af","Identifies when an account is enabled with a default password and the password is not set by the user within 48 hours.
Effectively, there is an event 4722 indicating an account was enabled and within 48 hours, no event 4723 occurs which 
indicates there was no attempt by the user to set the password. This will show any attempts (success or fail) that occur 
after 48 hours, which can indicate too long of a time period in setting the password to something that only the user knows.
It is recommended that this time period is adjusted per your internal company policy.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 3 days","",,"Available"
" ","High","Solorigate Named Pipe","Scheduled","11b4c19d-2a79-4da3-af38-b067e1273dee","Identifies a match across various data feeds for named pipe IOCs related to the Solorigate incident.
 For the sysmon events required for this detection, logging for Named Pipe Events needs to be configured in Sysmon config (Event ID 17 and Event ID 18)
 Reference: https://techcommunity.microsoft.com/t5/azure-sentinel/solarwinds-post-compromise-hunting-with-azure-sentinel/ba-p/1995095","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Low","Creation of expensive computes in Azure","Scheduled","9736e5f1-7b6e-4bfb-a708-e53ff1d182c3","Identifies the creation of large size/expensive VMs (GPU or with large no of virtual CPUs) in Azure.
Adversary may create new or update existing virtual machines sizes to evade defenses 
or use it for cryptomining purposes.
For Windows/Linux Vm Sizes - https://docs.microsoft.com/azure/virtual-machines/windows/sizes 
Azure VM Naming Conventions - https://docs.microsoft.com/azure/virtual-machines/vm-naming-conventions","AzureActivity","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to OfficeActivity","Scheduled","f15370f4-c6fa-42c5-9be4-1d308f40284e","Identifies a match in OfficeActivity from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|Office365","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","TI map Email entity to CommonSecurityLog","Scheduled","ffcd575b-3d54-482a-a6d8-d0de13b6ac63","Identifies a match in CommonSecurityLog table from any Email IOC from TI","PaloAltoNetworks|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","High","Azure VM Run Command operation executed during suspicious login window","Scheduled","11bda520-a965-4654-9a45-d09f372f71aa","Identifies when the Azure Run Command operation is executed by a UserPrincipalName and IP Address  
that has resulted in a recent user entity behaviour alert.","AzureActivity","Every 1 day","Last 2 days","",,"Available"
" ","Medium","ADFS DKM Master Key Export","Scheduled","18e6a87e-9d06-4a4e-8b59-3469cd49552d","Identifies an export of the ADFS DKM Master Key from Active Directory.
References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, 
https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1
To understand further the details behind this detection, please review the details in the original PR and subequent PR update to this:
https://github.com/Azure/Azure-Sentinel/pull/1562#issue-551542469
https://github.com/Azure/Azure-Sentinel/pull/1512#issue-543053339
","SecurityEvents|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Medium","MFA disabled for a user","Scheduled","65c78944-930b-4cae-bd79-c3664ae30ba7","Multi-Factor Authentication (MFA) helps prevent credential compromise. This alert identifies when an attempt has been made to disable MFA for a user ","AzureActiveDirectory|AWS","Every 1 hour","Last 1 hour","",,"Available"
" ","High","Modified domain federation trust settings","Scheduled","95dc4ae3-e0f2-48bd-b996-cdd22b90f9af","This will alert when a user or application modifies the federation settings on the domain or Update domain authentication from Managed to Federated.
For example, this alert will trigger when a new Active Directory Federated Service (ADFS) TrustedRealm object, such as a signing certificate, is added to the domain.
Modification to domain federation settings should be rare. Confirm the added or modified target domain/URL is legitimate administrator behavior.
To understand why an authorized user may update settings for a federated domain in Office 365, Azure, or Intune, see: https://docs.microsoft.com/office365/troubleshoot/active-directory/update-federated-domain-office-365.
For details on security realms that accept security tokens, see the ADFS Proxy Protocol (MS-ADFSPP) specification: https://docs.microsoft.com/openspecs/windows_protocols/ms-adfspp/e7b9ea73-1980-4318-96a6-da559486664b.
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Audit policy manipulation using auditpol utility","Scheduled","66276b14-32c5-4226-88e3-080dacc31ce1","This detects attempt to manipulate audit policies using auditpol command.
This technique was seen in relation to Solorigate attack but the results can indicate potential  malicious activity used in different attacks.
The process name in each data source is commented out as an adversary could rename it. It is advisable to keep process name commented but 
if the results show unrelated false positives, users may want to uncomment it.
Refer to auditpol syntax: https://docs.microsoft.com/windows-server/administration/windows-commands/auditpol  
Refer to our M365 blog for details on use during the Solorigate attack:
https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/","SecurityEvents|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Low","Squid proxy events related to mining pools","Scheduled","80733eb7-35b2-45b6-b2b8-3c51df258206","Checks for Squid proxy events in Syslog associated with common mining pools .This query presumes the default Squid log format is being used. 
 http://www.squid-cache.org/Doc/config/access_log/","Syslog","Every 1 day","Last 1 day","",,"Available"
" ","Low","External user added and removed in short timeframe","Scheduled","bff093b2-500e-4ae5-bb49-a5b1423cbd5b","This detection flags the occurances of external user accounts that are added to a Team and then removed within
one hour.","Office365","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","High Number of Urgent Vulnerabilities Detected","Scheduled","be52662c-3b23-435a-a6fa-f39bdfc849e6","This Creates an incident when a host has a high number of Urgent, severity 5, vulnerabilities detected.","QualysVulnerabilityManagement","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","ProofpointPOD - Binary file in attachment","Scheduled","eb68b129-5f17-4f56-bf6d-dde48d5e615a","Detects when email recieved with binary file as attachment.","ProofpointPOD","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Medium","Cognni Incidents for Medium Sensitivity Financial Information","Scheduled","d29b1d66-d4d9-4be2-b607-63278fc4fe6b","Display incidents in which medium sensitive financial information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Informational","(Preview) Domain generation algorithm (DGA) on DNS domains","Anomaly","b783df9c-4088-452e-a791-0c4fca47a109","This machine learning model indicates potential DGA domains in the second-level-domain (SLD) from the last day in the DNS logs.
The algorithm applies to the DNS records that resolve to IPv4 and IPv6 addresses.","DNS","","","Every 1 day",,"Available"
" ","High","PIM Elevation Request Rejected","Scheduled","7d7e20f8-3384-4b71-811c-f5e950e8306c","Identifies when a user is rejected for a privileged role elevation via PIM. Monitor rejections for indicators of attacker compromise of the requesting account.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-privileged-identity-management","AzureActiveDirectory","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","NOBELIUM - suspicious rundll32.exe execution of vbscript","Scheduled","d82e1987-4356-4a7b-bc5e-064f29b143c0","This query idenifies when rundll32.exe executes a specific set of inline VBScript commands
 References: https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Password spray attack against Azure AD application","Scheduled","48607a29-a26a-4abf-8078-a06dbdd174a4","Identifies evidence of password spray activity against Azure AD applications by looking for failures from multiple accounts from the same
IP address within a time window. If the number of accounts breaches the threshold just once, all failures from the IP address within the time range
are bought into the result. Details on whether there were successful authentications by the IP address within the time window are also included.
This can be an indicator that an attack was successful.
The default failure acccount threshold is 5, Default time window for failures is 20m and default look back window is 3 days
Note: Due to the number of possible accounts involved in a password spray it is not possible to map identities to a custom entity.
References: https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 7 days","",,"Available"
" ","Medium","Cognni Incidents for Medium Sensitivity Business Information","Scheduled","2c286288-3756-4824-b599-d3c499836c11","Display incidents in which medium sensitivity business information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Medium","Rare application consent","Scheduled","83ba3057-9ea3-4759-bf6a-933f2e5bc7ee","This will alert when the """"Consent to application"""" operation occurs by a user that has not done this operation before or rarely does this.
This could indicate that permissions to access the listed Azure App were provided to a malicious actor. 
Consent to application, Add service principal and Add OAuth2PermissionGrant should typically be rare events. 
This may help detect the Oauth2 attack that can be initiated by this publicly available tool - https://github.com/fireeye/PwnAuth
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 day","Last 7 days","",,"Available"
" ","Low","SSH - Potential Brute Force","Scheduled","e1ce0eab-10d1-4aae-863f-9a383345ba88","Identifies an IP address that had 15 failed attempts to sign in via SSH in a 4 hour block during a 24 hour time period.","Syslog","Every 1 day","Last 1 day","",,"Available"
" ",,"Create incidents based on Azure Active Directory Identity Protection alerts","MicrosoftSecurityIncidentCreation","532c1811-79ee-4d9f-8d4d-6304c840daa1","Create incidents based on all alerts generated in Azure Active Directory Identity Protection","AzureActiveDirectoryIdentityProtection","","","",,"Available"
" ","Informational","(Preview) Suspicious volume of AWS write API calls from a user account ","Anomaly","0c804654-63b9-4241-89f8-1cddd7e9cacd","This algorithm detects an unusually high volume of AWS write API calls per user account within the last day. The model is trained on the previous 21 days of AWS cloud trail log events on a user account basis. This activity may indicate that the account is compromised.","AWS","","","Every 1 day",,"Available"
" ","Low","Changes to Amazon VPC settings","Scheduled","65360bb0-8986-4ade-a89d-af3cf44d28aa","Amazon Virtual Private Cloud (Amazon VPC) lets you provision a logically isolated section of the AWS Cloud where you can launch AWS resources
in a virtual network that you define.
This identifies changes to Amazon VPC (Virtual Private Cloud) settings such as new ACL entries,routes, routetable or Gateways.
More information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255 
and AWS VPC API Docs: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/OperationList-query-vpc.html","AWS","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Potential Build Process Compromise","Scheduled","5ef06767-b37c-4818-b035-47de950d0046","The query looks for source code files being modified immediately after a build process is started. The purpose of this is to look for malicious code injection during the build process.
More details: https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-the-software-supply-chain-with-azure-sentinel/ba-p/2176463","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Potential domain generation algorithm (DGA) on next-level DNS Domains","Anomaly","7e38a3e4-ccb9-4c73-b4ee-290b3bed077c","This machine learning model indicates the next-level domains (third-level and up)
of the domain names from the last day of DNS logs are unusual. They could potentially be the output of a domain generation
algorithm (DGA). The anomaly applies to the DNS records that resolve to IPv4 and IPv6 addresses.","DNS","","","Every 1 day",,"Available"
" ","Medium","TI map Domain entity to PaloAlto","Scheduled","ec21493c-2684-4acd-9bc2-696dbad72426","Identifies a match in Palo Alto data in CommonSecurityLog table from any Domain IOC from TI","PaloAltoNetworks|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Low","Users searching for VIP user activity","Scheduled","f7f4a77e-f68f-4b56-9aaf-a0c9d87d7a8e","This query monitors for users running Log Analytics queries that contain filters
for specific, defined VIP user accounts or the VIPUser watchlist template.
Use this detection to alert for users specifically searching for activity of sensitive users.","","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Excessive upload via Palo Alto GlobalProtect","Anomaly","d0bd9611-2fc1-42cb-af4e-793b6f28ba92","This algorithm detects unusually high volume of upload per user account via Palo Alto VPN solution.
The model is trained on the previous 14 days of the VPN logs.
It indicates anomalous high volume of upload in the last day.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Medium","TI map Domain entity to Syslog","Scheduled","532f62c1-fba6-4baa-bbb6-4a32a4ef32fa","Identifies a match in Syslog table from any Domain IOC from TI","Syslog|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","ClientDeniedAccess","Scheduled","a9956d3a-07a9-44a6-a279-081a85020cae","Creates an incident in the event a Client has an excessive amounts of denied access requests.","SymantecVIP","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Time series anomaly for data size transferred to public internet","Scheduled","f2dd4a3a-ebac-4994-9499-1a859938c947","Identifies anomalous data transfer to public networks. The query leverages built-in KQL anomaly detection algorithms that detects large deviations from a baseline pattern.
A sudden increase in data transferred to unknown public networks is an indication of data exfiltration attempts and should be investigated.
The higher the score, the further it is from the baseline value.
The output is aggregated to provide summary view of unique source IP to destination IP address and port bytes sent traffic observed in the flagged anomaly hour.
The source IP addresses which were sending less than bytessentperhourthreshold have been exluded whose value can be adjusted as needed .
You may have to run queries for individual source IP addresses from SourceIPlist to determine if anything looks suspicious","CiscoASA|PaloAltoNetworks|AzureMonitor(VMInsights)","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Sign-ins from IPs that attempt sign-ins to disabled accounts (Uses Authentication Normalization)","Scheduled","95002681-4ecb-4da3-9ece-26d7e5feaa33","Identifies IPs with failed attempts to sign in to one or more disabled accounts signed in successfully to another account.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelAuthentication)","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to WireData","Scheduled","a50766a7-0674-4ccb-8845-15dc55a80ba1","Identifies a match in WireData from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureMonitor(WireData)","Every 1 hour","Last 14 days","",,"Available"
" ","High","Azure WAF matching for Log4j vuln(CVE-2021-44228)","Scheduled","2de8abd6-a613-450e-95ed-08e503369fb3","This query will alert on a positive pattern match by Azure WAF for CVE-2021-44228 log4j vulnerability exploitation attempt. If possible, it then decodes the malicious command for further analysis.
 Refrence: https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/","WAF","Every 6 hours","Last 6 hours","",,"Available"
" ","Low","Sensitive Azure Key Vault operations","Scheduled","d6491be0-ab2d-439d-95d6-ad8ea39277c5","Identifies when sensitive Azure Key Vault operations are used. This includes: VaultDelete, KeyDelete, SecretDelete, SecretPurge, KeyPurge, SecretBackup, KeyBackup. 
Any Backup operations should match with expected scheduled backup activity.","AzureKeyVault","Every 1 day","Last 1 day","",,"Available"
" ","Low","Possible STRONTIUM attempted credential harvesting - Sept 2020","Scheduled","04384937-e927-4595-8f3c-89ff58ed231f","Surfaces potential STRONTIUM group Office365 credential harvesting attempts within OfficeActivity Logon events.
References: https://www.microsoft.com/security/blog/2020/09/10/strontium-detecting-new-patters-credential-harvesting/.","Office365","Every 7 days","Last 14 days","",,"Available"
" ","Medium","TI map IP entity to CommonSecurityLog","Scheduled","66c81ae2-1f89-4433-be00-2fbbd9ba5ebe","Identifies a match in CommonSecurityLog from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Port Scan Detected","Scheduled","427e4c9e-8cf4-4094-a684-a2d060dbca38","This alert creates an incident when a source IP addresses attempt to communicate with a large amount of distinct ports within a short period.","SophosXGFirewall","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Azure Active Directory Hybrid Health AD FS Service Delete","Scheduled","86a036b2-3686-42eb-b417-909fc0867771","This detection uses AzureActivity logs (Administrative category) to identify the deletion of an Azure AD Hybrid health AD FS service instance in a tenant.
A threat actor can create a new AD Health ADFS service and create a fake server to spoof AD FS signing logs.
The health AD FS service can then be deleted after it is not longer needed via HTTP requests to Azure.
More information in this blog https://o365blog.com/post/hybridhealthagent/","AzureActivity","Every 1 day","Last 1 day","",,"Available"
" ","Medium","NOBELIUM - Script payload stored in Registry","Scheduled","00cb180c-08a8-4e55-a276-63fb1442d5b5","This query idenifies when a process execution commandline indicates that a registry value is written to allow for later execution a malicious script
 References: https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","User account enabled and disabled within 10 mins","Scheduled","3d023f64-8225-41a2-9570-2bd7c2c4535e","Identifies when a user account is enabled and then disabled within 10 minutes. This can be an indication of compromise and
an adversary attempting to hide in the noise.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1DT1 hour","",,"Available"
" ","Medium","Credential added after admin consented to Application","Scheduled","707494a5-8e44-486b-90f8-155d1797a8eb","This query will identify instances where Service Principal credentials were added to an application by one user after the application was granted admin consent rights by another user.
 If a threat actor obtains access to an account with sufficient privileges and adds the alternate authentication material triggering this event, the threat actor can now authenticate as the Application or Service Principal using this credential.
 Additional information on OAuth Credential Grants can be found in RFC 6749 Section 4.4 or https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.
 For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities","AzureActiveDirectory","Every 1 day","Last 2 days","",,"Available"
" ","Low","Changes made to AWS CloudTrail logs","Scheduled","610d3850-c26f-4f20-8d86-f10fdf2425f5","Attackers often try to hide their steps by deleting or stopping the collection of logs that could show their activity. 
This alert identifies any manipulation of AWS CloudTrail, Cloudwatch/EventBridge or VPC Flow logs.
More Information: AWS CloudTrail API: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_Operations.html
AWS Cloudwatch/Eventbridge API: https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_Operations.html
AWS DelteteFlowLogs API : https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteFlowLogs.html ","AWS","Every 1 day","Last 1 day","",,"Available"
" ","High","First access credential added to Application or Service Principal where no credential was present","Scheduled","2cfc3c6e-f424-4b88-9cc9-c89f482d016a","This will alert when an admin or app owner account adds a new credential to an Application or Service Principal where there was no previous verify KeyCredential associated.
If a threat actor obtains access to an account with sufficient privileges and adds the alternate authentication material triggering this event, the threat actor can now authenticate as the Application or Service Principal using this credential.
Additional information on OAuth Credential Grants can be found in RFC 6749 Section 4.4 or https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Possible Resource-Based Constrained Delegation Abuse","Scheduled","2937bc6b-7cda-4fba-b452-ea43ba8e835f","This query identifies Active Directory computer objects modifications that allow an adversary to abuse the Resource-based constrained delegation. 
This query checks for event id 5136 that the Object Class field is """"computer"""" and the LDAP Display Name is """"msDS-AllowedToActOnBehalfOfOtherIdentity"""" which is an indicator of Resource-based constrained delegation.
Ref: https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html","SecurityEvents","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","New executable via Office FileUploaded Operation","Scheduled","d722831e-88f5-4e25-b106-4ef6e29f8c13","Identifies when executable file types are uploaded to Office services such as SharePoint and OneDrive.
List currently includes 'exe', 'inf', 'gzip', 'cmd', 'bat' file extensions.
Additionally, identifies when a given user is uploading these files to another users workspace.
This may be indication of a staging location for malware or other malicious activity.","Office365","Every 1 day","Last 8 days","",,"Available"
" ","Medium","Exchange Server Vulnerabilities Disclosed March 2021 IoC Match","Scheduled","d804b39c-03a4-417c-a949-bdbf21fa3305","This detection look for IoCs shared by Microsoft relating to attacks exploiting the Exchange Server vulnerabilities disclosed in March 2021. It looks for SHA256 file hashes, IP addresses and file paths in a number of data sources. This query can also be customized with additional data sources that may include these elements.
Ref: https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/","AzureMonitor(IIS)|AzureMonitor(WireData)|CheckPoint|CiscoASA|CEF|F5|Fortinet|PaloAltoNetworks|SecurityEvents|WindowsFirewall|DNS","Every 1 hour","Last 1 hour","",,"Available"
" ","High","Missing Domain Controller Heartbeat","Scheduled","b8b8ba09-1e89-45a1-8bd7-691cd23bfa32","This detection will go over the heartbeats received from the agents of Domain Controllers over the last hour, and will create alerts if the last heartbeats were received an hour ago.","","Every 15 minutes","Last 2 hours","",,"Available"
" ","Medium","ADFS Database Named Pipe Connection","Scheduled","dcdf9bfc-c239-4764-a9f9-3612e6dff49c","This detection uses Sysmon telemetry to detect suspicious local connections via a named pipe to the AD FS configuration database (Windows Internal Database).
In order to use this query you need to be collecting Sysmon EventIdD 18 (Pipe Connected).
If you do not have Sysmon data in your workspace this query will raise an error stating:
Failed to resolve scalar expression named """"[@Name]","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Low","Cognni Incidents for Low Sensitivity Business Information","Scheduled","a0647a60-16f9-4175-b344-5cdd2934413f","Display incidents in which low sensitivity business information] was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Medium","Azure DevOps PAT used with Browser.","Scheduled","5f0d80db-3415-4265-9d52-8466b7372e3a","Personal Access Tokens (PATs) are used as an alternate password to authenticate into Azure DevOps. PATs are intended for programmatic access use in code or applications. 
This can be prone to attacker theft if not adequately secured. This query looks for the use of a PAT in authentication but from a User Agent indicating a browser. 
This should not be normal activity and could be an indicator of an attacker using a stolen PAT.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map Email entity to SigninLogs","Scheduled","30fa312c-31eb-43d8-b0cc-bcbdfb360822","Identifies a match in SigninLogs table from any Email IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureActiveDirectory|AzureActiveDirectory","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Malware in the recycle bin","Scheduled","75bf9902-0789-47c1-a5d8-f57046aa72df","The query detects Windows binaries, that can be used for executing malware, that have been hidden in the recycle bin. 
 The list of these binaries are sourced from https://lolbas-project.github.io/
 References: https://azure.microsoft.com/blog/how-azure-security-center-helps-reveal-a-cyberattack/.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","HAFNIUM Suspicious Exchange Request","Scheduled","23005e87-2d3a-482b-b03d-edbebd1ae151","This query looks for suspicious request patterns to Exchange servers that fit a pattern observed by HAFNIUM actors.
The same query can be run on HTTPProxy logs from on-premise hosted Exchange servers.
Reference: https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/","AzureMonitor(IIS)","Every 1 day","Last 14 days","",,"Available"
" ","Medium","GitHub Two Factor Auth Disable","Scheduled","3ff0fffb-d963-40c0-b235-3404f915add7","Two-factor authentication is a process where a user is prompted during the sign-in process for an additional form of identification, such as to enter a code on their cellphone or to provide a fingerprint scan. Two factor authentication reduces the risk of account takeover. Attacker will want to disable such security tools in order to go undetected. ","","Every 1 day","Last 1 day","",,"Available"
" ","High","Security Service Registry ACL Modification","Scheduled","473d57e6-f787-435c-a16b-b38b51fa9a4b","Identifies attempts to modify registry ACL to evade security solutions. In the Solorigate attack, the attackers were found modifying registry permissions so services.exe cannot access the relevant registry keys to start the service.
 The detection leverages Security Event as well as MDE data to identify when specific security services registry permissions are modified. 
 Only some portions of this detection are related to Solorigate, it also includes coverage for some common tools that perform this activity. 
 Reference on guidance for enabling registry auditing:
 - https://docs.microsoft.com/windows/security/threat-protection/auditing/advanced-security-auditing-faq
 - https://docs.microsoft.com/windows/security/threat-protection/auditing/appendix-a-security-monitoring-recommendations-for-many-audit-events
 - https://docs.microsoft.com/windows/security/threat-protection/auditing/audit-registry
 - https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4670
   - For the event 4670 to be created the audit policy for the registry must have auditing enabled for Write DAC and/or Write Owner
 - https://github.com/OTRF/Set-AuditRule 
 - https://docs.microsoft.com/dotnet/api/system.security.accesscontrol.registryrights?view=dotnet-plat-ext-5.0","SecurityEvents|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Cisco Umbrella - Crypto Miner User-Agent Detected","Scheduled","b619d1f1-7f39-4c7e-bf9e-afbb46457997","Detects suspicious user agent strings used by crypto miners in proxy logs.","CiscoUmbrellaDataConnector","Every 15 minutes","Last 15 minutes","",,"Available"
" ","Medium","Azure DevOps Pipeline Created and Deleted on the Same Day","Scheduled","17f23fbe-bb73-4324-8ecf-a18545a5dc26","An attacker with access to Azure DevOps could create a pipeline to inject artifacts used by other pipelines, 
or to create a malicious software build that looks legitimate by using a pipeline that incorporates legitimate elements. 
An attacker would also likely want to cover their tracks once conducting such activity. This query looks for Pipelines 
created and deleted within the same day, this is unlikely to be legitimate user activity in the majority of cases.","","Every 3 days","Last 3 days","",,"Available"
" ","Medium","TI map IP entity to W3CIISLog","Scheduled","5e45930c-09b1-4430-b2d1-cc75ada0dc0f","Identifies a match in W3CIISLog from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureMonitor(IIS)","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Group created then added to built in domain local or global group","Scheduled","a7564d76-ec6b-4519-a66b-fcc80c42332b","Identifies when a recently created Group was added to a privileged built in domain local group or global group such as the 
Enterprise Admins, Cert Publishers or DnsAdmins.  Be sure to verify this is an expected addition.
References: For AD SID mappings - https://docs.microsoft.com/windows/security/identity-protection/access-control/active-directory-security-groups.","SecurityEvents|WindowsSecurityEvents","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","(Preview) TI map IP entity to Dns Events (Normalized DNS)","Scheduled","67775878-7f8b-4380-ac54-115e1e828901","Identifies a match in DNS events from any IP IOC from TI
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelDns).","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Informational","(Preview) Suspicious volume of logins to user account with elevated token","Anomaly","a3863d8b-8be1-4f52-8ba2-d6cec98b606b","This algorithm detects an unusually high volume of successful logins with elevated token per user account. The model is trained on the previous 21 days of security event ID 4624 on an account. It indicates anomalous high volume of successful logins with administrator privileges in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","Medium","Potential DGA detected (ASimDNS)","Scheduled","983a6922-894d-413c-9f04-d7add0ecc307","Identifies clients with a high NXDomain count which could be indicative of a DGA (cycling through possible C2 domains
where most C2s are not live). Alert is generated when a new IP address is seen (based on not being seen associated with 
NXDomain records in prior 10-day baseline period).
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelDns)","","Every 1 day","Last 10 days","",,"Available"
" ","High","Solorigate Network Beacon","Scheduled","cecdbd4c-4902-403c-8d4b-32eb1efe460b","Identifies a match across various data feeds for domains IOCs related to the Solorigate incident.
 References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, 
 https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|MicrosoftThreatProtection|AzureFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","Informational","GitHub Security Vulnerability in Repository","Scheduled","5436f471-b03d-41cb-b333-65891f887c43","This alerts when there is a new security vulnerability in a GitHub repository.","","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","NOBELIUM - Domain and IP IOCs - March 2021","Scheduled","bb8a3481-dd14-4e76-8dcc-bbec8776d695","Identifies a match across various data feeds for domains and IP IOCs related to NOBELIUM.
 References: https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|MicrosoftThreatProtection|Office365|AzureFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","Informational","(Preview) Anomalous Azure AD sign-in sessions","Anomaly","2d3e33c6-d8e6-4b51-92d6-dbe8bd9efb05","The machine learning model groups the Azure AD sign-in logs on a per-user basis.
The model is trained on the previous 6 days of user sign-in behavior.
It indicates anomalous user sign-in sessions in the last day.
This algorithm checks for sufficient volume of data before training the model.

An autoencoder model is used.
Its aim is to compress the user sign-in sessions into a bottleneck encoding.
It then attempts to reconstruct the input sessions as best it can from the bottleneck encoding.
The sessions with high reconstruction errors are assumed to be anomalous.","AzureActiveDirectory","","","Every 1 day",,"Available"
" ","Medium","Account created or deleted by non-approved user","Scheduled","6d63efa6-7c25-4bd4-a486-aa6bf50fde8a","Identifies accounts that were created or deleted by a defined list of non-approved user principal names. Add to this list before running the query for accurate results.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-user-accounts","AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","High","User agent search for log4j exploitation attempt","Scheduled","29283b22-a1c0-4d16-b0a9-3460b655a46a","This query uses various log sources having user agent data to look for log4j CVE-2021-44228 exploitation attempt based on user agent pattern. Log4j is an open-source Apache logging library that is used in 
 many Java-based applications. The regex and the string matching look for the most common attacks. This might not be comprehensive to detect every possible user agent variation.
 Reference: https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/","WAF|Office365|AzureActiveDirectory|AzureActiveDirectory|AWS|AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Suspicious volume of failed login attempts to AWS Console by each group user account","Anomaly","b40a7a5b-5d39-46fe-a79e-2acdb38e1ce7","This algorithm detects an unusually high volume of AWS cloud trail log console failed login events per group user account within the last day. The model is trained on the previous 21 days of AWS cloud trail log events on group user account basis. This activity may indicate that the account is compromised.","AWS","","","Every 1 day",,"Available"
" ","Medium","TI map Email entity to OfficeActivity","Scheduled","4a3f5ed7-8da5-4ce2-af6f-c9ada45060f2","Identifies a match in OfficeActivity table from any Email IOC from TI","Office365|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Informational","(Preview) Domain Reputation Palo Alto anomaly","Anomaly","d4f9d54b-6dec-4655-8631-0fa8d4954fea","This anomaly evaluates the reputation for all domains seen specifically for Palo Alto firewall (PAN-OS product).
A high anomaly score indicates a low reputation, suggesting that the domain has been observed to host malicious content or is likely to do so.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Low","Suspicious link sharing pattern","Scheduled","1218175f-c534-421c-8070-5dcaabf28067","Alerts in links that have been shared across multiple Zoom chat channels by the same user in a short space if time. 
Adjust the threshold figure to change the number of channels a message needs to be posted in before an alert is raised.","","Every 1 day","Last 1 day","",,"Available"
" ","Low","Alsid Indicators of Exposures","Scheduled","154fde9f-ae00-4422-a8da-ef00b11da3fc","Searches for triggered Indicators of Exposures","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","High","Suspicious application consent similar to O365 Attack Toolkit","Scheduled","f948a32f-226c-4116-bddd-d95e91d97eb9","This will alert when a user consents to provide a previously-unknown Azure application with the same OAuth permissions used by the MDSec O365 Attack Toolkit (https://github.com/mdsecactivebreach/o365-attack-toolkit).
The default permissions/scope for the MDSec O365 Attack toolkit are contacts.read, user.read, mail.read, notes.read.all, mailboxsettings.readwrite, and files.readwrite.all.
Consent to applications with these permissions should be rare, especially as the knownApplications list is expanded, especially as the knownApplications list is expanded. Public contributions to expand this filter are welcome!
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Rare RDP Connections","Scheduled","45b903c5-6f56-4969-af10-ae62ac709718","Identifies when an RDP connection is new or rare related to any logon type by a given account today based on comparison with the previous 14 days.
RDP connections are indicated by the EventID 4624 with LogonType = 10","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 14 days","",,"Available"
" ","Informational","(Preview) Anomalous Password Reset","Anomaly","38781e25-924e-4c9d-9a76-8703077be83d","Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. Sentinel UEBA detects anomalies based on dynamic baselines created for each entity across various data inputs. Each entityâ€™s baseline behavior is set according to its own historical activities, those of its peers, and those of the organization as a whole. Anomalies can be triggered by the correlation of different attributes such as action type, geo-location, device, resource, ISP, and more.","AzureActiveDirectory","","","Every 1 day",,"Available"
" ",,"Create incidents based on Microsoft Defender for Endpoint alerts","MicrosoftSecurityIncidentCreation","327cd4ed-ca42-454b-887c-54e1c91363c6","Create incidents based on all alerts generated in Microsoft Defender for Endpoint","MicrosoftDefenderAdvancedThreatProtection","","","",,"Available"
" ","Medium","New internet-exposed SSH endpoints","Scheduled","4915c713-ab38-432e-800b-8e2d46933de6","Looks for SSH endpoints that rarely are accessed from a public IP address, in comparison with their history of sign-ins from private IP addresses.","Syslog","Every 1 day","Last 7 days","",,"Available"
" ","High","Probable AdFind Recon Tool Usage","Scheduled","c63ae777-d5e0-4113-8c9a-c2c9d3d09fcd","Identifies the host and account that executed AdFind by hash and filename in addition to common and unique flags that are used by many threat actors in discovery.","MicrosoftThreatProtection","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","DNS events related to mining pools (Normalized DNS)","Scheduled","c094384d-7ea7-4091-83be-18706ecca981","Identifies IP addresses that may be performing DNS lookups associated with common currency mining pools.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelDns)","","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Unusual web traffic detected with IP in URL path","Anomaly","1f6d7abe-2cb7-4a4c-aeca-91fe6bfad0b2","This algorithm identifies unusual web requests which have a direct IP address as the host. This can be an attempt to bypass URL reputation services etc for 
malicious purposes. The anomaly filters all web requests with IP addresses in the URL path and compares them with the previous week of data to exclude known benign traffic. 
After excluding known benign traffic, it triggers an anomaly only after exceeding certain thresholds with configured values such as total web requests, 
numbers of URLs seen with same host destination IP address, and number of distinct source IPs within the set of URLs with the same destination IP address.","PaloAltoNetworks|Zscaler|CEF|CheckPoint|Fortinet","","","Every 1 day",,"Available"
" ","Medium","GitHub Activites from a New Country","Scheduled","f041e01d-840d-43da-95c8-4188f6cef546","Detect activities from a location that was not recently or was never visited by the user or by any user in your organization.","","Every 1 day","Last 7 days","",,"Available"
" ","Informational","(Preview) Anomalous Azure operations","Anomaly","d7309cb9-b16b-4c7a-9e4b-3e9009bd373d","This detection algorithm generates anomaly of a caller who performed sequence of an operation(s) which is uncommon in their workspace.
We collect and featurize last 21 days of operation happened in the workspace grouped by the caller as a training data for ML algorithm.
The trained model is used to score the operation performed by the caller on the test date and we tag those caller as anomaly whose error score is greater than given thershold.
From Security perspective, this anomaly will capture the caller along with operation performed on the test date which are not common in their workspace.","AzureActivity","","","Every 1 day",,"Available"
" ","Medium","Base64 encoded Windows process command-lines (Normalized Process Events)","Scheduled","f8b3c49c-4087-499b-920f-0dcfaff0cbca","Identifies instances of a base64 encoded PE file header seen in the process command line parameter.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelProcessEvent)","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Zoom E2E Encryption Disabled","Scheduled","e4779bdc-397a-4b71-be28-59e6a1e1d16b","This alerts when end to end encryption is disabled for Zoom meetings.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map Domain entity to DnsEvent","Scheduled","85aca4d1-5d15-4001-abd9-acb86ca1786a","Identifies a match in DnsEvent table from any Domain IOC from TI","DNS|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Excessive NXDOMAIN DNS Queries","Scheduled","b8266f81-2715-41a6-9062-42486cbc9c73","This creates an incident in the event a client generates excessive amounts of DNS queries for non-existent domains.","InfobloxNIOS","Every 1 hour","Last 1 hour","",,"Available"
" ","High","Alsid DCShadow","Scheduled","25e0b2dd-3ad3-4d5b-80dd-720f4ef0f12c","Searches for DCShadow attacks","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Azure AD Health Service Agents Registry Keys Access","Scheduled","06bbf969-fcbe-43fa-bac2-b2fa131d113a","This detection uses Windows security events to detect suspicious access attempts to the registry key values and sub-keys of Azure AD Health service agents (e.g AD FS).
Information from AD Health service agents can be used to potentially abuse some of the features provided by those services in the cloud (e.g. Federation).
This detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object: HKLM:\SOFTWARE\Microsoft\ADHealthAgent.
Make sure you set the SACL to propagate to its sub-keys. You can find more information in here https://github.com/OTRF/Set-AuditRule/blob/master/rules/registry/aad_connect_health_service_agent.yml
","SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","(Preview) TI map Domain entity to Dns Events (Normalized DNS)","Scheduled","999e9f5d-db4a-4b07-a206-29c4e667b7e8","Identifies a match in DNS events from any Domain IOC from TI
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelDns).","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Gain Code Execution on ADFS Server via SMB + Remote Service or Scheduled Task","Scheduled","12dcea64-bec2-41c9-9df2-9f28461b1295","This query detects instances where an attacker has gained the ability to execute code on an ADFS Server through SMB and Remote Service or Scheduled Task.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 7 days","",,"Available"
" ","Low","Palo Alto - potential beaconing detected","Scheduled","f0be259a-34ac-4946-aa15-ca2b115d5feb","Identifies beaconing patterns from Palo Alto Network traffic logs based on recurrent timedelta patterns. 
The query leverages various KQL functions to calculate time deltas and then compares it with total events observed in a day to find percentage of beaconing. 
This outbound beaconing pattern to untrusted public networks should be investigated for any malware callbacks or data exfiltration attempts.
Reference Blog:
http://www.austintaylor.io/detect/beaconing/intrusion/detection/system/command/control/flare/elastic/stack/2017/06/10/detect-beaconing-with-flare-elasticsearch-and-intrusion-detection-systems/","PaloAltoNetworks","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Detect machine generated network beaconing behavior","Anomaly","622844c2-fc11-4efc-91e6-c05b06ab3008","This algorithm identifies beaconing patterns from network traffic connection logs based on recurrent time delta patterns.
Any network connection towards the untrusted public networks at repetitive time delta is an indication of malware callbacks or data exfiltration attempts. 
The anomaly will calculate time delta between consecutive network connection between same source and destination ip as well as count (Connections in time-delta sequence) of 
time-delta sequence between same source and destination. Percentage of beaconing is calculated between connections in time-delta sequence against total connections in a day.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Informational","(Preview) Suspicious volume of AWS API calls from Non-AWS source IP address from a user account id per workspace on a daily basis","Anomaly","32686052-5bed-48ef-9ffa-39fc7699f085","This algorithm detects an unusually high volume of AWS API calls from Source IPs not in AWS Source IP ranges from one user account per workspace within the last day. The model is trained on the previous 21 days of AWS cloud trail log events on source IP address basis. This activity may indicate that the user account is compromised.","AWS","","","Every 1 day",,"Available"
" ","Low","Threats detected by Eset","Scheduled","2d8a60aa-c15e-442e-9ce3-ee924889d2a6","Escalates threats detected by Eset.","EsetSMC","Every 5 minutes","Last 5 minutes","",,"Available"
" ","Low","Alsid privileged accounts issues","Scheduled","a5fe9489-cf8b-47ae-a87e-8f3a13e4203e","Searches for triggered Indicators of Exposures related to privileged accounts issues","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ",,"Create incidents based on Azure Defender alerts","MicrosoftSecurityIncidentCreation","90586451-7ba8-4c1e-9904-7d1b7c3cc4d6","Create incidents based on all alerts generated in Azure Defender","AzureSecurityCenter","","","",,"Available"
" ","Medium","TI map URL entity to Syslog data","Scheduled","b31037ea-6f68-4fbd-bab2-d0d0f44c2fcf","Identifies a match in Syslog data from any URL IOC from TI","Syslog|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Low","HAFNIUM Suspicious UM Service Error","Scheduled","0625fcce-6d52-491e-8c68-1d9b801d25b9","This query looks for errors that may indicate that an attacker is attempting to exploit a vulnerability in the service. 
Reference: https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/","","Every 1 day","Last 1 day","",,"Available"
" ","High","Known GALLIUM domains and hashes","Scheduled","26a3b261-b997-4374-94ea-6c37f67f4f39","GALLIUM command and control domains and hash values for tools and malware used by GALLIUM. 
 Matches domain name IOCs related to the GALLIUM activity group with CommonSecurityLog, DnsEvents, VMConnection and SecurityEvents dataTypes.
 References: https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/ ","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|SecurityEvents|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","High","Known NICKEL domains and hashes","Scheduled","9122a9cb-916b-4d98-a199-1b7b0af8d598","IOC domains and hash values for tools and malware used by NICKEL. 
 Matches domain name, hash IOCs and M365 Defender sigs related to the NICKEL activity group with CommonSecurityLog, DnsEvents, VMConnection and SecurityEvents dataTypes.","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|MicrosoftThreatProtection|MicrosoftThreatProtection|SecurityEvents|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","High","Alsid LSASS Memory","Scheduled","3acf5617-7c41-4085-9a79-cc3a425ba83a","Searches for OS Credentials dumping attacks","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Mail.Read Permissions Granted to Application","Scheduled","2560515c-07d1-434e-87fb-ebe3af267760","This query look for applications that have been granted (Delegated or App/Role) permissions to Read Mail (Permissions field has Mail.Read) and subsequently has been consented to. This can help identify applications that have been abused to gain access to mailboxes.","AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to AzureNetworkAnalytics_CL (NSG Flow Logs)","Scheduled","a4025a76-6490-4e6b-bb69-d02be4b03f07","Identifies a match in AzureNetworkAnalytics_CL (NSG Flow Logs) from any IP IOC from TI that was Allowed","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Network endpoint to host executable correlation","Scheduled","01f64465-b1ef-41ea-a7f5-31553a11ad43","Correlates blocked URLs hosting [malicious] executables with host endpoint data
to identify potential instances of executables of the same name having been recently run.","TrendMicro|SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Low","Suspicious Resource deployment","Scheduled","9fb57e58-3ed8-4b89-afcf-c8e786508b1c","Identifies when a rare Resource and ResourceGroup deployment occurs by a previously unseen Caller.","AzureActivity","Every 1 day","Last 14 days","",,"Available"
" ","Medium","New High Severity Vulnerability Detected Across Multiple Hosts","Scheduled","6116dc19-475a-4148-84b2-efe89c073e27","This creates an incident when a new high severity vulnerability is detected across multilple hosts","QualysVulnerabilityManagement","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Email access via active sync","Scheduled","2f561e20-d97b-4b13-b02d-18b34af6e87c","This query detects attempts to add attacker devices as allowed IDs for active sync using the Set-CASMailbox command.
This technique was seen in relation to Solorigate attack but the results can indicate potential malicious activity used in different attacks.
- Note that this query can be changed to use the KQL """"has_all"""" operator, which hasn't yet been documented officially, but will be soon.
  In short, """"has_all"""" will only match when the referenced field has all strings in the list.
- Refer to Set-CASMailbox syntax: https://docs.microsoft.com/powershell/module/exchange/set-casmailbox?view=exchange-ps  ","SecurityEvents|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Low","Alsid user accounts issues","Scheduled","fb9e0b51-8867-48d7-86f4-6e76f2176bf8","Searches for triggered Indicators of Exposures related to user accounts issues","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Informational","(Preview) Suspicious volume of logins to user account by logon types","Anomaly","29094df8-e0c7-4475-a74c-bda74a07affb","This algorithm detects an unusually high volume of successful logins per user account by different logon types. The model is trained on the previous 21 days of security event ID 4624 on an account. It indicates anomalous high volume of successful logins in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","Medium","User Accounts - Sign in Failure due to CA Spikes","Scheduled","3a9d5ede-2b9d-43a2-acc4-d272321ff77c"," Identifies spike in failed sign-ins from user accounts due to conditional access policied.
Spike is determined based on Time series anomaly which will look at historical baseline values.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-user-accounts#monitoring-for-failed-unusual-sign-ins","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Low","New user created and added to the built-in administrators group","Scheduled","aa1eff90-29d4-49dc-a3ea-b65199f516db","Identifies when a user account was created and then added to the builtin Administrators group in the same day.
This should be monitored closely and all additions reviewed.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","High","Cognni Incidents for Highly Sensitive Legal Information","Scheduled","4f45f43b-3a4b-491b-9cbe-d649603384aa","Display incidents in which highly sensitive legal information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Informational","(Preview) Suspicious volume of logins to user account","Anomaly","200f05a2-db6e-4ff7-be83-bbc30b44755f","This algorithm detects an unusually high volume of successful logins per user account. The model is trained on the previous 21 days of security event ID 4624 on an account. It indicates anomalous high volume of successful logins in the last day","SecurityEvents","","","Every 1 day",,"Available"
" ","Medium","High Number of Urgent Vulnerabilities Detected","Scheduled","3edb7215-250b-40c0-8b46-79093949242d","This Creates an incident when a host has a high number of Urgent, severity 5, vulnerabilities detected.","QualysVulnerabilityManagement","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","TI map Domain entity to CommonSecurityLog","Scheduled","dd0a6029-ecef-4507-89c4-fc355ac52111","Identifies a match in CommonSecurityLog table from any Domain IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","SharePointFileOperation via devices with previously unseen user agents","Scheduled","5dd76a87-9f87-4576-bab3-268b0e2b338b","Identifies if the number of documents uploaded or downloaded from device(s) associated
with a previously unseen user agent exceeds a threshold (default is 5).","Office365","Every 1 day","Last 14 days","",,"Available"
" ","Medium","New High Severity Vulnerability Detected Across Multiple Hosts","Scheduled","84cf1d59-f620-4fee-b569-68daf7008b7b","This creates an incident when a new high severity vulnerability is detected across multilple hosts","QualysVulnerabilityManagement","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","CoreBackUp Deletion in correlation with other related security alerts","Scheduled","011c84d8-85f0-4370-b864-24c13455aa94","This query will help detect attackers attempt to delete backup containers in correlation with other alerts that could have triggered to help possibly reveal more details of attacker activity. 
Though such an activity could be legitimate as part of business operation, some ransomware actors may perform such operation to cause interruption to regular business services.","AzureSecurityCenter","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Cisco - firewall block but success logon to Azure AD","Scheduled","157c0cfc-d76d-463b-8755-c781608cdc1a","Correlate IPs blocked by a Cisco firewall appliance with successful Azure Active Directory signins. 
Because the IP was blocked by the firewall, that same IP logging on successfully to AAD is potentially suspect
and could indicate credential compromise for the user account.","CiscoASA|AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","High","Known IRIDIUM IP","Scheduled","7ee72a9e-2e54-459c-bc8a-8c08a6532a63","IRIDIUM command and control IP. Identifies a match across various data feeds for IP IOCs related to the IRIDIUM activity group.","Office365|DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|SecurityEvents|AzureActiveDirectory|AzureActiveDirectory|AzureMonitor(IIS)|AzureActivity|AWS|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","High","Known Manganese IP and UserAgent activity","Scheduled","a04cf847-a832-4c60-b687-b0b6147da219","Matches IP plus UserAgent IOCs in OfficeActivity data, along with IP plus Connection string information in the CommonSecurityLog data related to Manganese group activity.
References: 
https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101/
https://fortiguard.com/psirt/FG-IR-18-384","Office365","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Successful logon from IP and failure from a different IP","Scheduled","02ef8d7e-fc3a-4d86-a457-650fa571d8d2","Identifies when a user account successfully logs onto an Azure App from one IP and within 10 mins failed to logon to the same App via a different IP.
This may indicate a malicious attempt at password guessing based on knowledge of the users account.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Low","Squid proxy events for ToR proxies","Scheduled","90d3f6ec-80fb-48e0-9937-2c70c9df9bad","Check for Squid proxy events associated with common ToR proxies. This query presumes the default squid log format is being used.
http://www.squid-cache.org/Doc/config/access_log/","Syslog","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Exchange workflow MailItemsAccessed operation anomaly","Scheduled","b4ceb583-4c44-4555-8ecf-39f572e827ba","Identifies anomalous increases in Exchange mail items accessed operations.
The query leverages KQL built-in anomaly detection algorithms to find large deviations from baseline patterns.
Sudden increases in execution frequency of sensitive actions should be further investigated for malicious activity.
Manually change scorethreshold from 1.5 to 3 or higher to reduce the noise based on outliers flagged from the query criteria.
Read more about MailItemsAccessed- https://docs.microsoft.com/microsoft-365/compliance/advanced-audit?view=o365-worldwide#mailitemsaccessed","Office365","Every 1 day","Last 14 days","",,"Available"
" ","High","Azure AD Role Management Permission Grant","Scheduled","1ff56009-db01-4615-8211-d4fda21da02d","Identifies when the Microsoft Graph RoleManagement.ReadWrite.Directory (Delegated or Application) permission is granted to a service principal.
This permission allows an application to read and manage the role-based access control (RBAC) settings for your company's directory.
An adversary could use this permission to add an Azure AD object to an Admin directory role and escalate privileges.
Ref : https://docs.microsoft.com/graph/permissions-reference#role-management-permissions
Ref : https://docs.microsoft.com/graph/api/directoryrole-post-members?view=graph-rest-1.0&tabs=http","AzureActiveDirectory","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Trust Monitor Event","Scheduled","8dcf7238-a7d0-4cfd-8d0c-b230e3cd9182","This query identifies when a new trust monitor event is detected.","","Every 5 minutes","Last 5 minutes","",,"Available"
" ","Low","Changes to internet facing AWS RDS Database instances","Scheduled","8c2ef238-67a0-497d-b1dd-5c8a0f533e25","Amazon Relational Database Service (RDS) is scalable relational database in the cloud. 
If your organization have one or more AWS RDS Databases running, monitoring changes to especially internet facing AWS RDS (Relational Database Service) 
Once alerts triggered, validate if changes observed are authorized and adhere to change control policy. 
More information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255
and RDS API Reference Docs: https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_Operations.html","AWS","Every 1 day","Last 1 day","",,"Available"
" ","High","Known ZINC Comebacker and Klackring malware hashes","Scheduled","09551db0-e147-4a0c-9e7b-918f88847605","ZINC attacks against security researcher campaign malware hashes.","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|SecurityEvents|MicrosoftThreatProtection|MicrosoftThreatProtection|MicrosoftThreatProtection|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map File Hash to Security Event","Scheduled","a7427ed7-04b4-4e3b-b323-08b981b9b4bf","Identifies a match in Security Event data from any File Hash IOC from TI","SecurityEvents|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Failed logon attempts in authpriv","Scheduled","e7ec9fa6-e7f7-41ed-a34b-b956837a3ee6","Identifies failed logon attempts from unknown users in Syslog authpriv logs. The unknown user means the account that tried to log in 
isn't provisioned on the machine. A few hits could indicate someone attempting to access a machine they aren't authorized to access. 
If there are many of hits, especially from outside your network, it could indicate a brute force attack. 
Default threshold for logon attempts is 15.","Syslog","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Explicit MFA Deny","Scheduled","a22740ec-fc1e-4c91-8de6-c29c6450ad00","User explicitly denies MFA push, indicating that login was not expected and the account's password may be compromised.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Anomalous user/app activities in Azure audit logs","Anomaly","3dccf381-2bb2-40c6-81a0-ab878bdf323f","This autoencoder model identifies anomalous user/app Azure sessions in audit logs for the last day.
We define 10 minutes to be the length of a session.
It groups the Azure audit logs on a per-user/app basis into sessions.
It compresses these user/app Azure sessions into a bottleneck encoding.
It then reconstructs the input sessions as best it can from the bottleneck encoding.
If the sessions have high reconstruction errors, they are assumed to be anomalous.
The model is trained on the previous 21 days of behavior across all users and apps.
This algorithm checks for sufficient volume of data before training the model.","AzureActiveDirectory","","","Every 1 day",,"Available"
" ","Low","Possible STRONTIUM attempted credential harvesting - Oct 2020","Scheduled","68271db2-cbe9-4009-b1d3-bb3b5fe5713c","Surfaces potential STRONTIUM group Office365 credential harvesting attempts within OfficeActivity Logon events.","Office365","Every 7 days","Last 14 days","",,"Available"
" ","Medium","Cisco Umbrella - Request to blocklisted file type","Scheduled","de58ee9e-b229-4252-8537-41a4c2f4045e","Detects request to potentially harmful file types (.ps1, .bat, .vbs, etc.).","CiscoUmbrellaDataConnector","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Medium","Potential communication with a Domain Generation Algorithm (DGA) based hostname (ASIM Web Session schema)","Scheduled","9176b18f-a946-42c6-a2f6-0f6d17cd6a8a","This rule identifies communication with hosts that have a domain name that might have been generated by a Domain Generation Algorithm (DGA). DGAs are used by malware to generate rendezvous points that are difficult to predict in advance. This detection uses the top 1 million domain names to build a model of what normal domains look like nad uses the model to identify domains that may have been randomly generated by an algorithm. You can modify the triThreshold and dgaLengthThreshold query parameters to change Analytic Rule sensitivity. The higher the numbers, the less noisy the rule is. <br>This rule uses the [Advanced SIEM Information Model (ASIM)](https://aka.ms/AboutASIM) and supports any network session source that compiles with ASIM. To use this Analytics Rule, [deploy the Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM).","","Every 6 hours","Last 6 hours","",,"Available"
" ","Informational","(Preview) Unusual mass downgrade AIP label","Anomaly","fc1b7e7a-bc24-42c3-ad67-5c76c8fcb2d6","This algorithm detects unusual high volume of downgrade label activity in Azure Information Protection (AIP) logs.
It considers """"AIP"""" workload records for a given number of days and determines the sequence of activity performed on documents along with the label applied to classify unusual volume of downgrade activity.","AzureInformationProtection","","","Every 1 day",,"Available"
" ","Medium","SUNSPOT malware hashes","Scheduled","53e936c6-6c30-4d12-8343-b8a0456e8429","This query uses Microsoft Defender for Endpoint data to look for IoCs associated with the SUNSPOT malware shared by Crowdstrike.
More details: 
  - https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/ 
  - https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-your-software-build-process-with-azure-sentinel/ba-p/2140807","MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Azure DevOps Build Variable Modified by New User.","Scheduled","3b9a44d7-c651-45ed-816c-eae583a6f2f1","Variables can be configured and used at any stage of the build process in Azure DevOps to inject values. An attacker with the required permissions could modify 
or add to these variables to conduct malicious activity such as changing paths or remote endpoints called during the build. As variables are often changed by users, 
just detecting these changes would have a high false positive rate. This detection looks for modifications to variable groups where that user has not been observed 
modifying them before.","","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Excessive NXDOMAIN DNS Queries (Normalized DNS)","Scheduled","c3b11fb2-9201-4844-b7b9-6b7bf6d9b851","This creates an incident in the event a client generates excessive amounts of DNS queries for non-existent domains. 
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelDns)","","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Failed AzureAD logons but success logon to host","Scheduled","8ee967a2-a645-4832-85f4-72b635bcb3a6","Identifies a list of IP addresses with a minimum number (default of 5) of failed logon attempts to Azure Active Directory.
Uses that list to identify any successful remote logons to hosts from these IPs within the same timeframe.","AzureActiveDirectory|AzureActiveDirectory|SecurityEvents|Syslog","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Suspicious number of protected documents accessed","Anomaly","543c9254-eb6f-4fdd-858d-783e0e3d5cb9","This algorithm is to detect high volume of access to protected documents in Azure Information Protection (AIP) logs. 
It considers AIP workload records for a given number of days and determines whether the user performed unusual access to protected documents in a day given his/her historical behavior.","AzureInformationProtection","","","Every 1 day",,"Available"
" ","Medium","TI map IP entity to Duo Security","Scheduled","d23ed927-5be3-4902-a9c1-85f841eb4fa1","Identifies a match in DuoSecurity from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","SUNBURST suspicious SolarWinds child processes","Scheduled","4a3073ac-7383-48a9-90a8-eb6716183a54","Identifies suspicious child processes of SolarWinds.Orion.Core.BusinessLayer.dll that may be evidence of the SUNBURST backdoor
References:
- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f","MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Low","Privileged Role Assigned Outside PIM","Scheduled","269435e3-1db8-4423-9dfc-9bf59997da1c","Identifies a privileged role being assigned to a user outside of PIM
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor-1","AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Low","AD account with Don't Expire Password","Scheduled","6c360107-f3ee-4b91-9f43-f4cfd90441cf","Identifies whenever a user account has the setting """"Password Never Expires"""" in the user account properties selected.
This is indicated in Security event 4738 in the EventData item labeled UserAccountControl with an included value of %%2089.
%%2089 resolves to """"Don't Expire Password - Enabled"""".","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Critical Threat Detected","Scheduled","2ca4e7fc-c61a-49e5-9736-5da8035c47e0","This creates an incident in the event a critical threat was identified on a Carbon Black managed endpoint.","VMwareCarbonBlack","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Alert for  IOCs related to Windows/ELF malware - IP, Hash IOCs - September 2021","Scheduled","d992b87b-eb49-4a9d-aa96-baacf9d26247","Identifies a match across various data feeds for IP,hashes and IOCs related to Windows/ELF malware published by Black Lotus Labs
Reference: 
https://blog.lumen.com/no-longer-just-theory-black-lotus-labs-uncovers-linux-executables-deployed-as-stealth-windows-loaders/
https://github.com/ManuelBerrueta/YARA-rules/blob/master/BlackLotusLabs-WSLMalware/BLL_SneakyWSL.yar","F5|CiscoASA|PaloAltoNetworks|Fortinet|CheckPoint|CEF|MicrosoftThreatProtection|SecurityEvents|AzureFirewall|WindowsFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","Medium","ProofpointPOD - Multiple large emails to the same recipient","Scheduled","d1aba9a3-5ab1-45ef-8ed4-da57dc3c0d32","Detects when multiple emails with lage size where sent to the same recipient.","ProofpointPOD","Every 30 minutes","Last 30 minutes","",,"Available"
" ","Medium","Starting or Stopping HealthService to Avoid Detection","Scheduled","2bc7b4ae-eeaa-4538-ba15-ef298ec1ffae","This query detects events where an actor is stopping or starting HealthService to disable telemetry collection/detection from the agent.
 The query requires a SACL to audit for access request to the service.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Possible contact with a domain generated by a DGA","Scheduled","4acd3a04-2fad-4efc-8a4b-51476594cec4","Identifies contacts with domains names in CommonSecurityLog that might have been generated by a Domain Generation Algorithm (DGA). DGAs can be used
by malware to generate rendezvous points that are difficult to predict in advance. This detection uses the Alexa Top 1 million domain names to build a model
of what normal domains look like. It uses this to identify domains that may have been randomly generated by an algorithm.
The triThreshold is set to 500 - increase this to report on domains that are less likely to have been randomly generated, decrease it for more likely.
The start time and end time look back over 6 hours of data and the dgaLengthThreshold is set to 8 - meaning domains whose length is 8 or more are reported.","Zscaler|Barracuda|CEF|CheckPoint|CiscoASA|F5|Fortinet|PaloAltoNetworks","Every 6 hours","Last 6 hours","",,"Available"
" ","Low","Multiple RDP connections from Single System","Scheduled","78422ef2-62bf-48ca-9bab-72c69818a425","Identifies when an RDP connection is made to multiple systems and above the normal for the previous 7 days.
Connections from the same system with the same account within the same day.
RDP connections are indicated by the EventID 4624 with LogonType = 10","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 8 days","",,"Available"
" ","Informational","AppServices AV Scan with Infected Files","Scheduled","9d0295ee-cb75-4f2c-9952-e5acfbb67036","Identifies if an AV scan finds infected files in Azure App Services.","","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Suspicious volume of AWS cloud trail logs events of group user account by EventTypeName","Anomaly","30dea201-74da-4141-8d21-8a18f0861d60","This algorithm detects an unusually high volume of AWS cloud trail log events per group user account by different event types (AwsApiCall, AwsServiceEvent, AwsConsoleSignIn, AwsConsoleAction) within the last day. The model is trained on the previous 21 days of AWS cloud trail log events on a group user account basis. This activity may indicate that the account is compromised.","AWS","","","Every 1 day",,"Available"
" ","Medium","TI map Email entity to SecurityAlert","Scheduled","a2e36ce0-da4d-4b6e-88c6-4e40161c5bfc","Identifies a match in SecurityAlert table from any Email IOC from TI which will extend coverage to datatypes such as MCAS, StorageThreatProtection and many others","AzureSecurityCenter|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","A host is potentially running PowerShell to send HTTP(S) requests (ASIM Web Session schema)","Scheduled","42436753-9944-4d70-801c-daaa4d19ddd2","This rule identifies a web request with a user agent header known to belong PowerShell. <br>You can add custom Powershell indicating User-Agent headers using a watchlist, for more information refer to the [UnusualUserAgents Watchlist](https://aka.ms/ASimUnusualUserAgentsWatchlist).<br><br>This rule uses the [Advanced SIEM Information Model (ASIM)](https://aka.ms/AboutASIM) and supports any web session source that complies with ASIM. To use this Analytics Rule, [deploy the Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM).","","Every 15 minutes","Last 15 minutes","",,"Available"
" ","Medium","ProofpointPOD - Multiple archived attachments to the same recipient","Scheduled","bda5a2bd-979b-4828-a91f-27c2a5048f7f","Detects when multiple emails where sent to the same recipient with large archived attachments.","ProofpointPOD","Every 30 minutes","Last 30 minutes","",,"Available"
" ","Medium","TI map File Hash to CommonSecurityLog Event","Scheduled","5d33fc63-b83b-4913-b95e-94d13f0d379f","Identifies a match in CommonSecurityLog Event data from any FileHash IOC from TI","PaloAltoNetworks|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","High","Create Incident for XDR Alerts (Medium & Low)","Scheduled","00282588-11e7-436d-90e8-011256c3c691","This Query creates an incident based on Trend Micro XDR Workbench Alerts and maps the impacted entities for Microsoft Sentinel usage. (Medium & Low Serverity Alerts)","TrendMicroXDR","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","Cognni Incidents for Low Sensitivity HR Information","Scheduled","ef8654b1-b2cf-4f6c-ae5c-eca635a764e8","Display incidents in which low sensitive HR information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Medium","A potentially malicious web request was executed against a web server","Scheduled","46ac55ae-47b8-414a-8f94-89ccd1962178","Detects unobstructed Web Application Firewall (WAF) activity in sessions where the WAF blocked incoming requests by computing the 
ratio between blocked requests and unobstructed WAF requests in these sessions (BlockvsSuccessRatio metric). A high ratio value for 
a given client IP and hostname calls for further investigation of the WAF data in that session, due to the significantly high number 
of blocked requests and a few unobstructed logs which may be malicious but have passed undetected through the WAF. The successCode 
variable defines what the detection thinks is a successful status code, and should be altered to fit the environment.","WAF","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Anomalous web request activity","Anomaly","edc946ae-cba8-419f-8e90-309966895956","This algorithm groups the W3CIIS logs into per site name and per URI stem hourly sessions.
The machine learning model identifies the sessions with anomalous requests that triggered response code 5xx in the last day.
5xx codes are an indication that some application instability or error condition has been triggered by the request.
They can be an indication that an attacker is probing the URI stem for vulnerabilities and configuration issues, performing some exploitation activity such as SQL injection, or leveraging an unpatched vulnerability.

The algorithm uses 6 days of data for training.
It identifies unusual high volume of web requests that generated respond code 5xx in the last day.","AzureMonitor(IIS)","","","Every 1 day",,"Available"
" ","Low","Request for single resource on domain","Scheduled","4d500e6d-c984-43a3-9f39-7edec8dcc04d","This will look for connections to a domain where only a single file is requested, this is unusual as most modern web applications require additional recources. This type of activity is often assocaited with malware beaconing or tracking URL's delivered in emails. Developed for Zscaler but applicable to any outbound web logging.","Zscaler","Every 1 day","Last 1 day","",,"Available"
" ","High","Known Phosphorus group domains/IP","Scheduled","155f40c6-610d-497d-85fc-3cf06ec13256","Matches domain name IOCs related to Phosphorus group activity with CommonSecurityLog, DnsEvents, OfficeActivity and VMConnection dataTypes.
References: https://blogs.microsoft.com/on-the-issues/2019/03/27/new-steps-to-protect-customers-from-hacking/.","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|Office365|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","High","Vulnerable Machines related to OMIGOD CVE-2021-38647","Scheduled","4d94d4a9-dc96-450a-9dea-4d4d4594199b","This query uses the Azure Defender Security Nested Recommendations data to find machines vulnerable to OMIGOD CVE-2021-38647. OMI is the Linux equivalent of Windows WMI and 
 helps users manage configurations across remote and local environments. The query aims to find machines that have this OMI vulnerability (CVE-2021-38647).
 Security Nested Recommendations data is sent to Microsoft Sentinel using the continuous export feature of Azure Defender(refrence link below).
 Reference: https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure
 Reference: https://docs.microsoft.com/azure/security-center/continuous-export?tabs=azure-portal","","Every 1 day","Last 1 day","",,"Available"
" ","High","User Assigned Privileged Role","Scheduled","050b9b3d-53d0-4364-a3da-1b678b8211ec","Identifies when a new privileged role is assigned to a user.  Any account eligible for a role is now being given privileged access. If the assignment is unexpected or into a role that isn't the responsibility of the account holder, investigate.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor-1","AzureActiveDirectory","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Cognni Incidents for Medium Sensitivity HR Information","Scheduled","75ff4f7d-0564-4a55-8b25-a75be951cde3","Display incidents in which medium sensitivity HR information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Medium","Malicious web application requests linked with Microsoft Defender for Endpoint (formerly Microsoft Defender ATP) alerts","Scheduled","fbfbf530-506b-49a4-81ad-4030885a195c","Takes Microsoft Defender for Endpoint (formerly Microsoft Defender ATP) alerts where web scripts are present in the evidence and correlates with requests made to those scripts
in the WCSIISLog to surface new alerts for potentially malicious web request activity.
The lookback for alerts is set to 1h and the lookback for W3CIISLogs is set to 7d. A sample set of popular web script extensions
has been provided in scriptExtensions that should be tailored to your environment.","MicrosoftDefenderAdvancedThreatProtection|AzureMonitor(IIS)","Every 1 hour","Last 7 days","",,"Available"
" ","Informational","(Preview) Suspicious volume of failed login attempts to AWS Console by each source IP address","Anomaly","e7277475-4e31-41c7-9997-0b8b3d7f00cd","This algorithm detects an unusually high volume of AWS cloud trail log console failed login events per source IP address within the last day. The model is trained on the previous 21 days of AWS cloud trail log events on source IP address basis. This activity may indicate that the IP address is compromised.","AWS","","","Every 1 day",,"Available"
" ","Medium","Gain Code Execution on ADFS Server via Remote WMI Execution","Scheduled","0bd65651-1404-438b-8f63-eecddcec87b4","This query detects instances where an attacker has gained the ability to execute code on an ADFS Server through remote WMI Execution.
In order to use this query you need to be collecting Sysmon EventIDs 19, 20, and 21.
If you do not have Sysmon data in your workspace this query will raise an error stating:
     Failed to resolve scalar expression named """"[@Name]""""
For more on how WMI was used in Solorigate see https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/.
The query contains some features from the following detections to look for potentially malicious ADFS activity. See them for more details.
- ADFS Key Export (Sysmon): https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityEvent/ADFSKeyExportSysmon.yaml
- ADFS DKM Master Key Export: https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/ADFS-DKM-MasterKey-Export.yaml","SecurityEvents","Every 1 day","Last 7 days","",,"Available"
" ","Medium","HAFNIUM Suspicious File Downloads.","Scheduled","03e04c97-8cae-48b3-9d2f-4ab262e4ffff","This query looks for messages related to file downloads of suspicious file types. This query uses the Exchange HttpProxy AOBGeneratorLog, you will need to onboard this log as a custom log under the table http_proxy_oab_CL before using this query. 
Reference: https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/","","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Anomalous Account Deletion","Anomaly","8bada072-c58c-4df3-a17e-e02392b48240","Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts.
Sentinel UEBA detects anomalies based on dynamic baselines created for each entity across various data inputs. Each entityâ€™s baseline behavior is set according to its own historical activities, those of its peers, and those of the organization as a whole. Anomalies can be triggered by the correlation of different attributes such as action type, geo-location, device, resource, ISP, and more.
Supported data sources: Azure Audit (Core Directory/UserManagement/Delete user, Core Directory/Device/Delete user, Core Directory/UserManagement/Delete user)","AzureActiveDirectory","","","Every 1 day",,"Available"
" ","Medium","Exchange AuditLog disabled","Scheduled","194dd92e-d6e7-4249-85a5-273350a7f5ce","Identifies when the exchange audit logging has been disabled which may be an adversary attempt
to evade detection or avoid other defenses.","Office365","Every 1 day","Last 1 day","",,"Available"
" ","High","NOBELIUM IOCs related to FoggyWeb backdoor","Scheduled","c37711a4-5f44-4472-8afc-0679bc0ef966","Identifies a match across various data feeds for IOCs related to FoggyWeb backdoor by the threat actor NOBELIUM.
 FoggyWeb is a passive and highly targeted backdoor capable of remotely exfiltrating sensitive information from a compromised AD FS server.
 It can also receive additional malicious components from a command-and-control (C2) server and execute them on the compromised server.
 Reference: https://aka.ms/nobelium-foggy-web","F5|CiscoASA|PaloAltoNetworks|Fortinet|CheckPoint|CEF|MicrosoftThreatProtection|SecurityEvents|WindowsSecurityEvents|AzureMonitor(IIS)","Every 6 hours","Last 6 hours","",,"Available"
" ","Low","Account added and removed from privileged groups","Scheduled","7efc75ce-e2a4-400f-a8b1-283d3b0f2c60","Identifies accounts that are added to privileged group and then quickly removed, which could be a sign of compromise.' ","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Low","Alsid Password issues","Scheduled","472b7cf4-bf1a-4061-b9ab-9fe4894e3c17","Searches for triggered Indicators of Exposures related to password issues","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","High","Cognni Incidents for Highly Sensitive Financial Information","Scheduled","7ebb7386-6c99-4331-aab1-a185a603eb47","Display incidents in which highly sensitive financial information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Informational","(Preview) Suspicious geography change in Palo Alto GlobalProtect account logins","Anomaly","25bf2f45-1cf0-47d2-b394-a7b331d707b3","When a Palo Alto GlobalProtect account logs in from a geographically new region that is not the same as the last region the day before, an anomaly will be generated.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Medium","ServicePrincipalNameAssignedToUserAccount","Scheduled","875d0eb1-883a-4191-bd0e-dbfdeb95a464","This query identifies whether a Active Directory user object was assigned a service principal name which could indicate that an adversary is preparing for performing Kerberoasting. 
This query checks for event id 5136 that the Object Class field is """"user"""" and the LDAP Display Name is """"servicePrincipalName"""".
Ref: https://thevivi.net/assets/docs/2019/theVIVI-AD-Security-Workshop_AfricaHackon2019.pdf","SecurityEvents","Every 1 hour","Last 1 hour","",,"Available"
" ","High","Dev-0228 File Path Hashes November 2021","Scheduled","3b443f22-9be9-4c35-ac70-a94757748439","This hunting query looks for  file paths/hashes related to observed activity by Dev-0228. The actor is known to use custom version of popular tool like PsExec, Procdump etc. to carry its activity.
 The risk score associated with each result is based on a number of factors, hosts with higher risk events should be investigated first.","MicrosoftDefenderAdvancedThreatProtection|MicrosoftThreatProtection","Every 6 hours","Last 6 hours","",,"Available"
" ","Medium","HAFNIUM New UM Service Child Process","Scheduled","95a15f39-d9cc-4667-8cdd-58f3113691c9","This query looks for new processes being spawned by the Exchange UM service where that process has not previously been observed before. 
Reference: https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Anomalous sign-in location by user account and authenticating application","Scheduled","7cb8f77d-c52f-4e46-b82f-3cf2e106224a","This query over Azure Active Directory sign-in considers all user sign-ins for each Azure Active 
Directory application and picks out the most anomalous change in location profile for a user within an 
individual application. An alert is generated for recent sign-ins that have location counts that are anomalous
over last day but also over the last 3-day and 7-day periods.
Please note that on workspaces with larger volume of Signin data (~10M+ events a day) may timeout when using this default query time period.
It is recommended that you test and tune this appropriately for the workspace.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Potential Password Spray Attack (Uses Authentication Normalization)","Scheduled","6a2e2ff4-5568-475e-bef2-b95f12b9367b","This query searches for failed attempts to log in from more than 15 various users within a 5 minute timeframe from the same source. This is a potential indication of a password spray attack
 To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelAuthentication)","","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","Cisco ASA - average attack detection rate increase","Scheduled","79f29feb-6a9d-4cdf-baaa-2daf480a5da1","This will help you determine if Cisco ASA devices are under heavier attack than normal over the last hour versus the previous 6 hours based on DeviceEventClassID 733100
References: https://www.cisco.com/c/en/us/td/docs/security/asa/syslog/b_syslog/syslogs9.html
Details on how to further troubleshoot/investigate: https://www.cisco.com/c/en/us/support/docs/security/asa-5500-x-series-next-generation-firewalls/113685-asa-threat-detection.html","CiscoASA","Every 1 hour","Last 6 hours","",,"Available"
" ","Medium","Vectra AI Detect - New Campaign Detected","Scheduled","a34d0338-eda0-42b5-8b93-32aae0d7a501","Identifies when a new Campaign has been detected.  This occurs when multiple Detections accross different Hosts are suspected to be part of the same Attack Campaign.","AIVectraDetect","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Malicious Inbox Rule","Scheduled","7b907bf7-77d4-41d0-a208-5643ff75bf9a","Often times after the initial compromise the attackers create inbox rules to delete emails that contain certain keywords. 
 This is done so as to limit ability to warn compromised users that they've been compromised. Below is a sample query that tries to detect this.
Reference: https://www.reddit.com/r/sysadmin/comments/7kyp0a/recent_phishing_attempts_my_experience_and_what/","Office365","Every 1 day","Last 1 day","",,"Available"
" ","Low","New CloudShell User","Scheduled","6d7214d9-4a28-44df-aafb-0910b9e6ae3e","Identifies when a user creates an Azure CloudShell for the first time.
Monitor this activity to ensure only expected user are using CloudShell","AzureActivity","Every 1 day","Last 1 day","",,"Available"
" ","Low","SecurityEvent - Multiple authentication failures followed by a success","Scheduled","cf3ede88-a429-493b-9108-3e46d3c741f7","Identifies accounts who have failed to logon to the domain multiple times in a row, followed by a successful authentication
within a short time frame. Multiple failed attempts followed by a success can be an indication of a brute force attempt or
possible mis-configuration of a service account within an environment.
The lookback is set to 6h and the authentication window and threshold are set to 1h and 5, meaning we need to see a minimum
of 5 failures followed by a success for an account within 1 hour to surface an alert.","SecurityEvents|WindowsSecurityEvents","Every 6 hours","Last 6 hours","",,"Available"
" ","Low","Excessive Denied Proxy Traffic","Scheduled","7a58b253-0ef2-4248-b4e5-c350f15a8346","This alert creates an incident when a client generates an excessive amounts of denied proxy traffic.","SymantecProxySG","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Attempts to sign in to disabled accounts","Scheduled","75ea5c39-93e5-489b-b1e1-68fa6c9d2d04","Identifies failed attempts to sign in to disabled accounts across multiple Azure Applications.
Default threshold for Azure Applications attempted to sign in to is 3.
References: https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes
50057 - User account is disabled. The account has been disabled by an administrator.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Failed AWS Console logons but success logon to AzureAD","Scheduled","910124df-913c-47e3-a7cd-29e1643fa55e","Identifies a list of IP addresses with a minimum numbe(default of 5) of failed logon attempts to AWS Console.
Uses that list to identify any successful Azure Active Directory logons from these IPs within the same timeframe.","AzureActiveDirectory|AWS","Every 1 day","Last 1 day","",,"Available"
" ","Low","Monitor AWS Credential abuse or hijacking","Scheduled","32555639-b639-4c2b-afda-c0ae0abefa55","Looking for GetCallerIdentity Events where the UserID Type is AssumedRole 
An attacker who has assumed the role of a legitimate account can call the GetCallerIdentity function to determine what account they are using.
A legitimate user using legitimate credentials would not need to call GetCallerIdentity since they should already know what account they are using.
More Information: https://duo.com/decipher/trailblazer-hunts-compromised-credentials-in-aws
AWS STS GetCallerIdentity API: https://docs.aws.amazon.com/STS/latest/APIReference/API_GetCallerIdentity.html ","AWS","Every 1 day","Last 1 day","",,"Available"
" ","Medium","User Accessed Suspicious URL Categories","Scheduled","fb0f4a93-d8ad-4b54-9931-85bdb7550f90","Creates an incident in the event the requested URL accessed by the user has been identified as Suspicious, Phishing, or Hacking.","SymantecProxySG","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Distributed Password cracking attempts in AzureAD","Scheduled","bfb1c90f-8006-4325-98be-c7fffbc254d6","Identifies distributed password cracking attempts from the Azure Active Directory SigninLogs.
The query looks for unusually high number of failed password attempts coming from multiple locations for a user account.
References: https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes
50053   Account is locked because the user tried to sign in too many times with an incorrect user ID or password.
50055   Invalid password, entered expired password.
50056   Invalid or null password - Password does not exist in store for this user.
50126   Invalid username or password, or invalid on-premises username or password.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Powershell Empire cmdlets seen in command line","Scheduled","ef88eb96-861c-43a0-ab16-f3835a97c928","Identifies instances of PowerShell Empire cmdlets in powershell process command line data.","SecurityEvents|WindowsSecurityEvents","Every 12 hours","Last 12 hours","",,"Available"
" ","Medium","Potential DGA detected","Scheduled","a0907abe-6925-4d90-af2b-c7e89dc201a6","Identifies clients with a high NXDomain count which could be indicative of a DGA (cycling through possible C2 domains
where most C2s are not live). Alert is generated when a new IP address is seen (based on not being seen associated with 
NXDomain records in prior 10-day baseline period).","DNS","Every 1 day","Last 10 days","",,"Available"
" ","Medium","External guest invitations by default guest followed by Azure AD powershell signin","Scheduled","acc4c247-aaf7-494b-b5da-17f18863878a","By default guests have capability to invite more external guest user, who can do suspicious Azure AD enumeration. This detection will first look at guests 
inviting external guests users who are then logging via various powershell CLI after accepting invitation.
Ref : 'https://danielchronlund.com/2021/11/18/scary-azure-ad-tenant-enumeration-using-regular-b2b-guest-accounts/","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Informational","AppServices AV Scan Failure","Scheduled","c2da1106-bfe4-4a63-bf14-5ab73130ccd5","Identifies if an AV scan fails in Azure App Services.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Azure Active Directory Hybrid Health AD FS Suspicious Application","Scheduled","d9938c3b-16f9-444d-bc22-ea9a9110e0fd","This detection uses AzureActivity logs (Administrative category) to a suspicious application adding a server instance to an Azure AD Hybrid health AD FS service or deleting the AD FS service instance.
Usually the Azure AD Connect Health Agent application with ID cf6d7e68-f018-4e0a-a7b3-126e053fb88d is used to perform those operations.","AzureActivity","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Anomalous local account creation","Anomaly","c5644575-4982-4a07-8884-b11ec2866dc3","This algorithm is to detect anomalous local account creation on windows systems. Adversaries may create local accounts to maintain access to victim systems.
This algorithm analyzes historical local account creation activity (14 days) by users and compare with current day to find similar activity from the users who were not 
previously seen in historical activity. You can further customize the allowlist to filter known users from triggering this anomaly.","SecurityEvents","","","Every 1 day",,"Available"
" ","High","Exchange OAB Virtual Directory Attribute Containing Potential Webshell","Scheduled","faf1a6ff-53b5-4f92-8c55-4b20e9957594","This query uses Windows Event ID 5136 in order to detect potential webshell deployment by exploitation of CVE-2021-27065.
This query looks for changes to the InternalHostName or ExternalHostName properties of Exchange OAB Virtual Directory objects in AD Directory Services
where the new objects contain potential webshell objects. Ref: https://aka.ms/ExchangeVulns","SecurityEvents|WindowsSecurityEvents","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Malware in the recycle bin (Normalized Process Events)","Scheduled","61988db3-0565-49b5-b8e3-747195baac6e","Identifies malware that has been hidden in the recycle bin.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelProcessEvent)","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Azure DevOps Service Connection Addition/Abuse - Historic allow list","Scheduled","5efb0cfd-063d-417a-803b-562eae5b0301","This detection builds an allow list of historic service connection use by Builds and Releases and compares to recent history, flagging growth of service connection use which are not manually included in the allow list and 
not historically included in the allow list Build/Release runs.  This is to determine if someone is hijacking a build/release and adding many service connections in order to abuse or dump credentials from service connections.","","Every 6 hours","Last 14 days","",,"Available"
" ","Medium","Anomalous login followed by Teams action","Scheduled","2b701288-b428-4fb8-805e-e4372c574786","Detects anomalous IP address usage by user accounts and then checks to see if a suspicious Teams action is performed.
Query calculates IP usage Delta for each user account and selects accounts where a delta >= 90% is observed between the most and least used IP.
To further reduce results the query performs a prevalence check on the lowest used IP's country, only keeping IP's where the country is unusual for the tenant (dynamic ranges)
Finally the user accounts activity within Teams logs is checked for suspicious commands (modifying user privileges or admin actions) during the period the suspicious IP was active.","Office365|AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Azure DevOps Variable Secret Not Secured","Scheduled","4ca74dc0-8352-4ac5-893c-73571cc78331","Credentials used in the build process may be stored as Azure DevOps variables. To secure these variables they should be stored in KeyVault or marked as Secrets. 
This detection looks for new variables added with names that suggest they are credentials but where they are not set as Secrets or stored in KeyVault.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Cisco Umbrella - Connection to non-corporate private network","Scheduled","c9b6d281-b96b-4763-b728-9a04b9fe1246","IP addresses of broadband links that usually indicates users attempting to access their home network, for example for a remote session to a home computer.","CiscoUmbrellaDataConnector","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Medium","Cisco Umbrella - Connection to Unpopular Website Detected","Scheduled","75297f62-10a8-4fc1-9b2a-12f25c6f05a7","Detects first connection to an unpopular website (possible malicious payload delivery).","CiscoUmbrellaDataConnector","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Excessive Failed Authentication from Invalid Inputs","Scheduled","c775a46b-21b1-46d7-afa6-37e3e577a27b","Creates an incident in the event that a user generates an excessive amount of failed authentications due to invalid inputs, indications of a potential brute force.","SymantecVIP","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Brute force attack against a Cloud PC","Scheduled","3fbc20a4-04c4-464e-8fcb-6667f53e4987","Identifies evidence of brute force activity against a Windows 365 Cloud PC by highlighting multiple authentication failures and by a successful authentication within a given time window.","AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Low","DNS events related to ToR proxies (Normalized DNS)","Scheduled","3fe3c520-04f1-44b8-8398-782ed21435f8","Identifies IP addresses performing DNS lookups associated with common ToR proxies.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelDns)","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Cognni Incidents for Medium Sensitivity Governance Information","Scheduled","c1d4a005-e220-4d06-9e53-7326a22b8fe4","Display incidents in which medium sensitivity governance information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Low","Chia_Crypto_Mining - Domain, Process, Hash and IP IOCs - June 2021","Scheduled","595a10c9-91be-4abb-bbc7-ae9c57848bef","Identifies a match across various data feeds for domains, process, hashes and IP IOC related to Chia cryptocurrency farming/plotting activity.","DNS|AzureMonitor(VMInsights)|F5|CiscoASA|PaloAltoNetworks|Fortinet|CheckPoint|CEF|MicrosoftThreatProtection|SecurityEvents|Office365|AzureFirewall|WindowsFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","Medium","TI map IP entity to Azure SQL Security Audit Events","Scheduled","d0aa8969-1bbe-4da3-9e76-09e5f67c9d85","Identifies a match in SQLSecurityAuditEvents from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Informational","(Preview) Attempted computer bruteforce","Anomaly","8a602940-4153-4045-a741-3bf15591ae29","This algorithm detects an unusually high volume of failed login attempts to each computer. The model is trained on the previous 21 days of security event ID 4625 on a computer. It indicates anomalous high volume of failed login attempts in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","High","Probable AdFind Recon Tool Usage (Normalized Process Events)","Scheduled","45076281-35ae-45e0-b443-c32aa0baf965","Identifies the host and account that executed AdFind by hash and filename in addition to common and unique flags that are used by many threat actors in discovery.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelProcessEvent)","","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","TI map URL entity to PaloAlto data","Scheduled","106813db-679e-4382-a51b-1bfc463befc3","Identifies a match in PaloAlto data from any URL IOC from TI","PaloAltoNetworks|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Brute Force Attack against GitHub Account","Scheduled","97ad74c4-fdd9-4a3f-b6bf-5e28f4f71e06","Attackers who are trying to guess your users' passwords or use brute-force methods to get in. If your organization is using SSO with Azure Active Directory, authentication logs to GitHub.com will be generated. Using the following query can help you identify a sudden increase in failed logon attempt of users.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","High","Advanced Multistage Attack Detection","Fusion","f71aba3d-28fb-450b-b192-4e76a83015c8","Microsoft Sentinel uses Fusion, a correlation engine based on scalable machine learning algorithms, to automatically detect multistage attacks by identifying combinations of anomalous behaviors and suspicious activities that are observed at various stages of the kill chain. On the basis of these discoveries, Azure Sentinel generates incidents that would otherwise be very difficult to catch. By design, these incidents are low-volume, high-fidelity, and high-severity, which is why this detection is turned ON by default.

Since Fusion correlates multiple signals from various products to detect advanced multistage attacks, successful Fusion detections are presented as Fusion incidents on the Microsoft Sentinel Incidents page. This rule covers the following detections:
- Fusion for emerging threats
- Fusion for ransomware
- Scenario-based Fusion detections (122 scenarios)

To enable these detections, we recommend you configure the following data connectors for best results:
- Out-of-the-box anomaly detections
- Azure Active Directory Identity Protection
- Azure Defender
- Azure Defender for IoT
- Microsoft 365 Defender
- Microsoft Cloud App Security    
- Microsoft Defender for Endpoint
- Microsoft Defender for Identity
- Microsoft Defender for Office 365
- Palo Alto Networks
- Scheduled analytics rules, both built-in and those created by your security analysts. Analytics rules must contain kill-chain (tactics) and entity mapping information in order to be used by Fusion.

For the full description of each detection that is supported by Fusion, go to https://aka.ms/SentinelFusion.","","","","",,"Installed"
" ","Medium","NOBELIUM - Domain, Hash and IP IOCs - May 2021","Scheduled","677da133-e487-4108-a150-5b926591a92b","Identifies a match across various data feeds for domains, hashes and IP IOCs related to NOBELIUM.
Ref: https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/","DNS|AzureMonitor(VMInsights)|F5|CiscoASA|PaloAltoNetworks|Fortinet|CheckPoint|CEF|MicrosoftThreatProtection|SecurityEvents|Office365|AzureFirewall|WindowsFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","Medium","ProofpointPOD - Suspicious attachment","Scheduled","f6a51e2c-2d6a-4f92-a090-cfb002ca611f","Detects when email contains suspicious attachment (file type).","ProofpointPOD","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Medium","Failed AzureAD logons but success logon to AWS Console","Scheduled","643c2025-9604-47c5-833f-7b4b9378a1f5","Identifies a list of IP addresses with a minimum number(defualt of 5) of failed logon attempts to Azure Active Directory.
Uses that list to identify any successful AWS Console logons from these IPs within the same timeframe.","AzureActiveDirectory|AzureActiveDirectory|AWS","Every 1 day","Last 1 day","",,"Available"
" ","High","Vectra AI Detect - Detections with High Severity","Scheduled","39e48890-2c02-487e-aa9e-3ba494061798","Create an incident for high severity malicious behavior detected by Vectra AI (Threat score superior to 7.0). 
The Severity is a mapping with the Threat score assigned to a detection. It ranges between 0 and 10. 
The severity_threshold variable can be adjusted as desired.' ","AIVectraDetect","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","TI map Email entity to SecurityEvent","Scheduled","2fc5d810-c9cc-491a-b564-841427ae0e50","Identifies a match in SecurityEvent table from any Email IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|SecurityEvents","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","(Preview) Anomalous SSH Login Detection","MLBehaviorAnalytics","fa118b98-de46-4e94-87f9-8e6d5060b60b","This detection uses machine learning (ML) to identify anomalous Secure Shell (SSH) login activity, based on syslog data. Scenarios include:

*	Unusual IP - This IP address has not or has rarely been seen in last 30 days.
*	Unusual Geo - The IP address, city, country and ASN have not (or rarely) been seen in last 30 days.
*	New user - A new user logs in from an IP address and geo location, both or either of which are not expected to be seen in the last 30 days.

Allow 7 days after this alert is enabled for Microsoft Sentinel to build a profile of normal activity for your environment.

This detection requires a specific configuration of the data source. [Learn more](https://docs.microsoft.com/en-us/azure/sentinel/connect-syslog#configure-the-syslog-connector-for-anomalous-ssh-login-detection)

By enabling this rule, you give Microsoft permission to copy ingested data outside of your Microsoft Sentinel workspace's geography as necessary for processing by the machine learning engine.","Syslog","","","",,"Available"
" ","High","High Urgency Cyberpion Action Items","Scheduled","8e0403b1-07f8-4865-b2e9-74d1e83200a4","This query creates an alert for active Cyberpion Action Items with high urgency (9-10).
 Urgency can be altered using the """"min_urgency"""" variable in the query.","CyberpionSecurityLogs","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Azure VM Run Command operations executing a unique powershell script","Scheduled","5239248b-abfb-4c6a-8177-b104ade5db56","Identifies when Azure Run command is used to execute a powershell script on a VM that is unique.
The uniqueness of the powershell script is determined by taking a combined hash of the cmdlets it imports
and the filesize of the PowerShell script. Alerts from this detection indicate a unique PowerShell was executed
in your environment.","AzureActivity|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","High","Cognni Incidents for Highly Sensitive Governance Information","Scheduled","2926ce29-08d2-4654-b2e8-7d8df70095d9","Display incidents in which highly sensitive governance information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ",,"Create incidents based on Microsoft Defender for Identity alerts","MicrosoftSecurityIncidentCreation","40ba9493-4183-4eee-974f-87fe39c8f267","Create incidents based on all alerts generated in Microsoft Defender for Identity","AzureAdvancedThreatProtection","","","",,"Available"
" ","Medium","Azure AD Health Monitoring Agent Registry Keys Access","Scheduled","f819c592-c5f9-4d5c-a79f-1e6819863533","This detection uses Windows security events to detect suspicious access attempts to the registry key of Azure AD Health monitoring agent.
This detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object HKLM\SOFTWARE\Microsoft\Microsoft Online\Reporting\MonitoringAgent.
You can find more information in here https://github.com/OTRF/Set-AuditRule/blob/master/rules/registry/aad_connect_health_monitoring_agent.yml
","SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Attempted user account bruteforce","Anomaly","ffe3625d-a933-4f63-b192-7e6ebf3be5fb","This algorithm detects an unusually high volume of failed login attempts per user account. The model is trained on the previous 21 days of security event ID 4625 on an account. It indicates anomalous high volume of failed login attempts in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","Medium","GitHub Signin Burst from Multiple Locations","Scheduled","d3980830-dd9d-40a5-911f-76b44dfdce16","This alerts when there Signin burst from multiple locations in GitHub (AAD SSO).","AzureActiveDirectory|AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","AD FS Remote HTTP Network Connection","Scheduled","d57c33a9-76b9-40e0-9dfa-ff0404546410","This detection uses Sysmon events (NetworkConnect events) to detect incoming network traffic on port 80 on AD FS servers. This could be a sign of a threat actor
trying to use replication services on the AD FS server to get its configuration settings and extract sensitive information such as AD FS certificates.
In order to use this query you need to enable Sysmon telemetry on the AD FS Server.
Reference: https://twitter.com/OTR_Community/status/1387038995016732672
","SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","High","Log4j vulnerability exploit aka Log4Shell IP IOC","Scheduled","6e575295-a7e6-464c-8192-3e1d8fd6a990","Identifies a match across various data feeds for IP IOCs related to the Log4j vulnerability exploit aka Log4Shell described in CVE-2021-44228.  
 References: https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228' ","Office365|DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|SecurityEvents|AzureActiveDirectory|AzureActiveDirectory|AzureMonitor(WireData)|AzureMonitor(IIS)|AzureActivity|AWS|MicrosoftThreatProtection|AzureFirewall","Every 1 hour","Last 1 hour","",,"Available"
" ","High","SUNBURST and SUPERNOVA backdoor hashes","Scheduled","a3c144f9-8051-47d4-ac29-ffb0c312c910","Identifies SolarWinds SUNBURST and SUPERNOVA backdoor file hash IOCs in DeviceFileEvents
References:
- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f","MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Medium","IP with multiple failed Azure AD logins successfully logs in to Palo Alto VPN","Scheduled","ba144bf8-75b8-406f-9420-ed74397f9479","This query creates a list of IP addresses with a number failed login attempts to AAD 
above a set threshold.  It then looks for any successful Palo Alto VPN logins from any
of these IPs within the same timeframe.","AzureActiveDirectory|AzureActiveDirectory|PaloAltoNetworks","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Known Malware Detected","Scheduled","9f86885f-f31f-4e66-a39d-352771ee789e","This creates an incident when a known Malware is detected on a endpoint managed by a Carbon Black.","VMwareCarbonBlack","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","Rare and potentially high-risk Office operations","Scheduled","957cb240-f45d-4491-9ba5-93430a3c08be","Identifies Office operations that are typically rare and can provide capabilities useful to attackers.","Office365","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Suspicious volume of logins to computer","Anomaly","9c712bb2-08dc-44d3-b66b-af154dfc1c4f","This algorithm detects an unusually high volume of successful logins per computer. The model is trained on the previous 21 days of security event ID 4624 on a computer. It indicates anomalous high volume of successful logins in the last day","SecurityEvents","","","Every 1 day",,"Available"
" ","Medium","High count of connections by client IP on many ports","Scheduled","44a555d8-ecee-4a25-95ce-055879b4b14b","Identifies when 30 or more ports are used for a given client IP in 10 minutes occurring on the IIS server.
This could be indicative of attempted port scanning or exploit attempt at internet facing web applications.  
This could also simply indicate a misconfigured service or device.
References:
IIS status code mapping - https://support.microsoft.com/help/943891/the-http-status-code-in-iis-7-0-iis-7-5-and-iis-8-0
Win32 Status code mapping - https://msdn.microsoft.com/library/cc231199.aspx","AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Office policy tampering","Scheduled","fbd72eb8-087e-466b-bd54-1ca6ea08c6d3","Identifies if any tampering is done to either auditlog, ATP Safelink, SafeAttachment, AntiPhish or Dlp policy. 
An adversary may use this technique to evade detection or avoid other policy based defenses.
References: https://docs.microsoft.com/powershell/module/exchange/advanced-threat-protection/remove-antiphishrule?view=exchange-ps.","Office365","Every 1 day","Last 1 day","",,"Available"
" ","High","Solorigate Domains Found in VM Insights","Scheduled","ab4b6944-a20d-42ab-8b63-238426525801","Identifies connections to Solorigate-related DNS records based on VM insights data","AzureMonitor(VMInsights)|AzureMonitor(VMInsights)|AzureMonitor(VMInsights)","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","Changes to AWS Elastic Load Balancer security groups","Scheduled","c7bfadd4-34a6-4fa5-82f8-3691a32261e8","Elastic Load Balancer distributes incoming traffic across multiple instances in multiple availability Zones. This increases the fault tolerance of your applications. 
 Unwanted changes to Elastic Load Balancer specific security groups could open your environment to attack and  hence needs monitoring.
 More information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255 
 and https://aws.amazon.com/elasticloadbalancing/.","AWS","Every 1 day","Last 1 day","",,"Available"
" ","Medium","MFA Rejected by User","Scheduled","d99cf5c3-d660-436c-895b-8a8f8448da23","Identifies accurances where a user has rejected an MFA prompt. This could be an indicator that a threat actor has compromised the username and password of this user account and is using it to try and log into the account.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-user-accounts#monitoring-for-failed-unusual-sign-ins","AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","High","THALLIUM domains included in DCU takedown","Scheduled","70b12a3b-4896-42cb-910c-5ffaf8d7987d","THALLIUM spearphishing and command and control domains included in December 2019 DCU/MSTIC takedown. 
 Matches domain name IOCs related to the THALLIUM activity group with CommonSecurityLog, DnsEvents, VMConnection and SecurityEvents dataTypes.
 References: https://blogs.microsoft.com/on-the-issues/2019/12/30/microsoft-court-action-against-nation-state-cybercrime/ ","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","High","Dev-0228 File Path Hashes November 2021 - ASIM","Scheduled","29a29e5d-354e-4f5e-8321-8b39d25047bf","This hunting query looks for  file paths/hashes related to observed activity by Dev-0228. The actor is known to use custom version of popular tool like PsExec, Procdump etc. to carry its activity.
 The risk score associated with each result is based on a number of factors, hosts with higher risk events should be investigated first.
 This query uses the Microsoft Sentinel Information Model - https://docs.microsoft.com/azure/sentinel/normalization","","Every 6 hours","Last 6 hours","",,"Available"
" ","High","Admin promotion after Role Management Application Permission Grant","Scheduled","f80d951a-eddc-4171-b9d0-d616bb83efdc","This rule looks for a service principal being granted the Microsoft Graph RoleManagement.ReadWrite.Directory (application) permission before being used to add an Azure AD object or user account to an Admin directory role (i.e. Global Administrators).
This is a known attack path that is usually abused when a service principal already has the AppRoleAssignment.ReadWrite.All permission granted. This permission Allows an app to manage permission grants for application permissions to any API.
A service principal can promote itself or other service principals to admin roles (i.e. Global Administrators). This would be considered a privilege escalation technique.
Ref : https://docs.microsoft.com/graph/permissions-reference#role-management-permissions, https://docs.microsoft.com/graph/api/directoryrole-post-members?view=graph-rest-1.0&tabs=http","AzureActiveDirectory","Every 2 hours","Last 2 hours","",,"Available"
" ","High","Cognni Incidents for Highly Sensitive Business Information","Scheduled","44e80f00-b4f5-486b-a57d-4073746276df","Display incidents in which highly sensitive business information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","High","SUPERNOVA webshell","Scheduled","2acc91c3-17c2-4388-938e-4eac2d5894e8","Identifies SUPERNOVA webshell based on W3CIISLog data.
 References:
 - https://unit42.paloaltonetworks.com/solarstorm-supernova/","AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Process executed from binary hidden in Base64 encoded file","Scheduled","d6190dde-8fd2-456a-ac5b-0a32400b0464","Encoding malicious software is a technique used to obfuscate files from detection. 
The first CommandLine component is looking for Python decoding base64. 
The second CommandLine component is looking for Bash/sh command line base64 decoding.
The third one is looking for Ruby decoding base64.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","NOBELIUM - suspicious rundll32.exe execution of vbscript (Normalized Process Events)","Scheduled","bdf04f58-242b-4729-b376-577c4bdf5d3a","This query idenifies when rundll32.exe executes a specific set of inline VBScript commands
References: https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelProcessEvent)","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map URL entity to AuditLogs","Scheduled","712fab52-2a7d-401e-a08c-ff939cc7c25e","Identifies a match in AuditLogs from any URL IOC from TI","AzureActiveDirectory|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Potential Build Process Compromise - MDE","Scheduled","1bf6e165-5e32-420e-ab4f-0da8558a8be2","The query looks for source code files being modified immediately after a build process is started. The purpose of this is to look for malicious code injection during the build process. This query uses Microsoft Defender for Endpoint telemetry.
More details: https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-the-software-supply-chain-with-azure-sentinel/ba-p/2176463","MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Medium","User account created and deleted within 10 mins","Scheduled","4b93c5af-d20b-4236-b696-a28b8c51407f","Identifies when a user account is created and then deleted within 10 minutes. This can be an indication of compromise and
an adversary attempting to hide in the noise.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1DT1 hour","",,"Available"
" ","Low","Rare subscription-level operations in Azure","Scheduled","23de46ea-c425-4a77-b456-511ae4855d69","This query looks for a few sensitive subscription-level events based on Azure Activity Logs. 
 For example this monitors for the operation name 'Create or Update Snapshot' which is used for creating backups but could be misused by attackers 
 to dump hashes or extract sensitive information from the disk.","AzureActivity","Every 1 day","Last 14 days","",,"Available"
" ","Low","ProofpointPOD - High risk message not discarded","Scheduled","c7cd6073-6d2c-4284-a5c8-da27605bdfde","Detects when email with high risk score was not rejected or discarded by filters.","ProofpointPOD","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Informational","(Preview) Anomalous user activities in Office Exchange","Anomaly","16d55bbb-8c54-4c1d-8537-521824e76bb6","This machine learning model groups the Office Exchange logs on a per-user basis into hourly buckets. We define one
hour as a session. The model is trained on the previous 7 days of behavior across all regular (non-admin) users.
It indicates anomalous user Office Exchange sessions in the last day.
This algorithm checks for sufficient volume of data before training the model.

An autoencoder model is used.
Its aim is to compress the user Office Exchange sessions into a bottleneck encoding.
It then attempts to reconstruct the input sessions as best it can from the bottleneck encoding.
The sessions with high reconstruction errors are assumed to be anomalous.","Office365","","","Every 1 day",,"Available"
" ","High","DEV-0322 Serv-U related IOCs - July 2021","Scheduled","4759ddb4-2daf-43cb-b34e-d85b85b4e4a5","Identifies a match across IOC's related to DEV-0322 targeting SolarWinds Serv-U software.","DNS|AzureMonitor(VMInsights)|F5|CiscoASA|PaloAltoNetworks|Fortinet|CheckPoint|CEF|MicrosoftThreatProtection|SecurityEvents|Office365|AzureFirewall|WindowsFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","Medium","Several deny actions registered","Scheduled","f8dad4e9-3f19-4d70-ab7f-8f19ccd43a3e","Identifies attack pattern when attacker tries to move, or scan, from resource to resource on the network and creates an incident when a source has more than 1 registered deny action in Azure Firewall.","AzureFirewall","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Potential DHCP Starvation Attack","Scheduled","57e56fc9-417a-4f41-a579-5475aea7b8ce","This creates an incident in the event that an excessive amount of DHCPREQUEST have been recieved by a DHCP Server and could potentially be an indication of a DHCP Starvation Attack.","InfobloxNIOS","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","(Preview) Microsoft Threat Intelligence Analytics","ThreatIntelligence","0dd422ee-e6af-4204-b219-f59ac172e4c6","This rule generates an alert when a Microsoft Threat Intelligence Indicator gets matched with your event logs. The alerts are very high fidelity.

Note : It is advised to turn off any custom alert rules which match the threat intelligence indicators with the same event logs matched by this analytics to prevent duplicate alerts.","CEF|DNS|Syslog","","","",,"Available"
" ","Medium","Excessive number of failed connections from a single source (ASIM Network Session schema)","Scheduled","4902eddb-34f7-44a8-ac94-8486366e9494","This rule identifies that a single source generates an excessive amount of failed connections. Modify the threshold to change the sensitivity of the rule: the higher the threshold, the less sensitive is the rule and less incidents will be generated.<br><br>This rule uses the [Advanced SIEM Information Model (ASIM)](https://aka.ms/AboutASIM) and supports any network session source that complies with ASIM. To use this Analytics Rule, [deploy the Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM).","","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Potential Password Spray Attack","Scheduled","e27dd7e5-4367-4c40-a2b7-fcd7e7a8a508","This query searches for failed attempts to log into the Okta console from more than 15 various users within a 5 minute timeframe from the same source. This is a potential indication of a password spray attack","OktaSSO","Every 1 hour","Last 1 hour","",,"Available"
" ","Informational","(Preview) Attempted user account bruteforce per failure reason","Anomaly","93c4b361-ea7d-40f4-9ca6-e501cdef9c53","This algorithm detects an unusually high volume of failed login attempts per user account per failure reason. The model is trained on the previous 21 days of security event ID 4625 on an account and a failure reason. It indicates anomalous high volume of failed login attempts with certain failure reason in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","High","HAFNIUM UM Service writing suspicious file","Scheduled","7d6d8a8e-b08a-4082-8dbb-d7fd2cbbc35e","This query looks for the Exchange server UM process writing suspicious files that may be indicative of webshells.
Reference: https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/","SecurityEvents|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","High","Alsid DCSync","Scheduled","d3c658bd-8da9-4372-82e4-aaffa922f428","Searches for DCSync attacks","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Azure Active Directory Hybrid Health AD FS New Server","Scheduled","88f453ff-7b9e-45bb-8c12-4058ca5e44ee","This detection uses AzureActivity logs (Administrative category) to identify the creation or update of a server instance in an Azure AD Hybrid health AD FS service.
A threat actor can create a new AD Health ADFS service and create a fake server instance to spoof AD FS signing logs. There is no need to compromise an on-prem AD FS server.
This can be done programmatically via HTTP requests to Azure. More information in this blog: https://o365blog.com/post/hybridhealthagent/","AzureActivity","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Potential Kerberoasting","Scheduled","1572e66b-20a7-4012-9ec4-77ec4b101bc8","A service principal name (SPN) is used to uniquely identify a service instance in a Windows environment. 
Each SPN is usually associated with a service account. Organizations may have used service accounts with weak passwords in their environment. 
An attacker can try requesting Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC) which contains 
a hash of the Service account. This can then be used for offline cracking. This hunting query looks for accounts that are generating excessive 
requests to different resources within the last hour compared with the previous 24 hours.  Normal users would not make an unusually large number 
of request within a small time window. This is based on 4769 events which can be very noisy so environment based tweaking might be needed.","SecurityEvents|WindowsSecurityEvents","Every 1 hour","Last 1 day","",,"Available"
" ","High","MSHTML vulnerability CVE-2021-40444 attack","Scheduled","972c89fa-c969-4d12-932f-04d55d145299","This query detects attacks that exploit the CVE-2021-40444 MSHTML vulnerability using specially crafted Microsoft Office documents. 
 The detection searches for relevant files used in the attack along with regex matches in commnadline to look for pattern similar to : """".cpl:../../msword.inf""""
 Refrence: https://www.microsoft.com/security/blog/2021/09/15/analyzing-attacks-that-exploit-the-mshtml-cve-2021-40444-vulnerability/","SecurityEvents|MicrosoftThreatProtection","Every 1 hour","Last 1 hour","",,"Available"
" ","High","AdminSDHolder Modifications","Scheduled","52aec824-96c1-4a03-8e44-bb70532e6cea","This query detects modification in the AdminSDHolder  in the Active Directory which could indicate an attempt for persistence. 
AdminSDHolder Modification is a persistence technique in which an attacker abuses the SDProp process in Active Directory to establish a persistent backdoor to Active Directory.
This query searches for the event id 5136 where the Object DN is AdminSDHolder.
Ref: https://attack.stealthbits.com/adminsdholder-modification-ad-persistence","SecurityEvents","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","Azure Key Vault access TimeSeries anomaly","Scheduled","0914adab-90b5-47a3-a79f-7cdcac843aa7","Indentifies a sudden increase in count of Azure Key Vault secret or vault access operations by CallerIPAddress. The query leverages a built-in KQL anomaly detection algorithm
to find large deviations from baseline Azure Key Vault access patterns. Any sudden increase in the count of Azure Key Vault accesses can be an
indication of adversary dumping credentials via automated methods. If you are seeing any noise, try filtering known source(IP/Account) and user-agent combinations.
TimeSeries Reference Blog: https://techcommunity.microsoft.com/t5/azure-sentinel/looking-for-unknown-anomalies-what-is-normal-time-series/ba-p/555052","AzureKeyVault","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Mail redirect via ExO transport rule","Scheduled","500415fb-bba7-4227-a08a-9857fb61b6a7","Identifies when Exchange Online transport rule configured to forward emails.
This could be an adversary mailbox configured to collect mail from multiple user accounts.","Office365","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to Azure Key Vault logs","Scheduled","57c7e832-64eb-411f-8928-4133f01f4a25","Identifies a match in Azure Key Vault logsfrom any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureKeyVault","Every 1 hour","Last 14 days","",,"Available"
" ","Low","Anomalous User Agent connection attempt","Scheduled","f845881e-2500-44dc-8ed7-b372af3e1e25","Identifies connection attempts (success or fail) from clients with very short or very long User Agent strings and with less than 100 connection attempts.","AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map Email entity to AzureActivity","Scheduled","cca3b4d9-ac39-4109-8b93-65bb284003e6","Identifies a match in AzureActivity table from any Email IOC from TI","AzureActivity|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Low","Azure DevOps Retention Reduced","Scheduled","71d374e0-1cf8-4e50-aecd-ab6c519795c2","AzureDevOps retains items such as run records and produced artifacts for a configurable amount of time. An attacker looking to reduce the footprint left by their malicious activity may look to reduce the retention time for artifacts and runs.
This query will look for where retention has been reduced to the minimum level - 1, or reduced by more than half.","","Every 1 day","Last 1 day","",,"Available"
" ","Low","Cognni Incidents for Low Sensitivity Governance Information","Scheduled","d2e40c79-fe8c-428e-8cb9-0e2282d4558c","Display incidents in which low sensitivity governance information] was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Medium","A host is potentially running a hacking tool (ASIM Web Session schema)","Scheduled","3f0c20d5-6228-48ef-92f3-9ff7822c1954","This rule identifies a web request with a user agent header known to belong to a hacking tool. This indicates a hacking tool is used on the host.<br>You can add custom hacking tool indicating User-Agent headers using a watchlist, for more information refer to the [UnusualUserAgents Watchlist](https://aka.ms/ASimUnusualUserAgentsWatchlist).<br><br>This rule uses the [Advanced SIEM Information Model (ASIM)](https://aka.ms/AboutASIM) and supports any web session source that complies with ASIM. To use this Analytics Rule, [deploy the Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM).","","Every 15 minutes","Last 15 minutes","",,"Available"
" ","Medium","User added to Azure Active Directory Privileged Groups","Scheduled","4d94d4a9-dc96-410a-8dea-4d4d4584188b","This will alert when a user is added to any of the Privileged Groups.
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.
For Administrator role permissions in Azure Active Directory please see https://docs.microsoft.com/azure/active-directory/users-groups-roles/directory-assign-admin-roles","AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Sign-ins from IPs that attempt sign-ins to disabled accounts","Scheduled","500c103a-0319-4d56-8e99-3cec8d860757","Identifies IPs with failed attempts to sign in to one or more disabled accounts and where that same IP has had successful signins from other accounts.
This could indicate an attacker who obtained credentials for a list of accounts and is attempting to login with those accounts, some of which may have already been disabled.
References: https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes
50057 - User account is disabled. The account has been disabled by an administrator.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","High","Alsid Password Spraying","Scheduled","9e20eb4e-cc0d-4349-a99d-cad756859dfb","Searches for Password spraying attacks","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Cisco Umbrella - Hack Tool User-Agent Detected","Scheduled","8d537f3c-094f-430c-a588-8a87da36ee3a","Detects suspicious user agent strings used by known hack tools","CiscoUmbrellaDataConnector","Every 15 minutes","Last 15 minutes","",,"Available"
" ","Medium","Azure Portal Signin from another Azure Tenant","Scheduled","87210ca1-49a4-4a7d-bb4a-4988752f978c","This query looks for sign in attempts to the Azure Portal where the user who is signing in from another Azure tenant,
 and the IP address the login attempt is from is an Azure IP. A threat actor who compromises an Azure tenant may look
 to pivot to other tenants leveraging cross-tenant delegated access in this manner.","AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","Informational","(Preview) Anomalous Account Creation","Anomaly","f209187f-1d17-4431-94af-c141bf5f23db","Adversaries may create an account to maintain access to victim systems. With a sufficient level of access,
creating such accounts may be used to establish secondary credentialed access
that do not require persistent remote access tools to be deployed on the system.","AzureActiveDirectory","","","Every 1 day",,"Available"
" ","Medium","Cisco Umbrella - Windows PowerShell User-Agent Detected","Scheduled","b12b3dab-d973-45af-b07e-e29bb34d8db9","Rule helps to detect Powershell user-agent activity by an unusual process other than a web browser.","CiscoUmbrellaDataConnector","Every 15 minutes","Last 15 minutes","",,"Available"
" ","Low","PulseConnectSecure - Potential Brute Force Attempts","Scheduled","34663177-8abf-4db1-b0a4-5683ab273f44","This query identifies evidence of potential brute force attack by looking at multiple failed attempts to log into the VPN server","PulseConnectSecure","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Rare client observed with high reverse DNS lookup count","Scheduled","15ae38a2-2e29-48f7-883f-863fb25a5a06","Identifies clients with a high reverse DNS counts which could be carrying out reconnaissance or discovery activity.
Alert is generated if the IP performing such reverse DNS lookups was not seen doing so in the preceding 7-day period.","DNS","Every 1 day","Last 8 days","",,"Available"
" ","Low","Mass secret retrieval from Azure Key Vault","Scheduled","24f8c234-d1ff-40ec-8b73-96b17a3a9c1c","Identifies mass secret retrieval from Azure Key Vault observed by a single user. 
Mass secret retrival crossing a certain threshold is an indication of credential dump operations or mis-configured applications. 
You can tweak the EventCountThreshold based on average count seen in your environment 
and also filter any known sources (IP/Account) and useragent combinations based on historical analysis to further reduce noise","AzureKeyVault","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Suspicious application consent similar to PwnAuth","Scheduled","39198934-62a0-4781-8416-a81265c03fd6","This will alert when a user consents to provide a previously-unknown Azure application with the same OAuth permissions used by the FireEye PwnAuth toolkit (https://github.com/fireeye/PwnAuth).
The default permissions/scope for the PwnAuth toolkit are user.read, offline_access, mail.readwrite, mail.send, and files.read.all.
Consent to applications with these permissions should be rare, especially as the knownApplications list is expanded. Public contributions to expand this filter are welcome!
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 day","Last 14 days","",,"Available"
" ","Medium","New PA, PCA, or PCAS added to Azure DevOps","Scheduled","35ce9aff-1708-45b8-a295-5e9a307f5f17","In order for an attacker to be able to conduct many potential attacks against Azure DevOps they will need to gain elevated permissions. 
This detection looks for users being granted key administrative permissions. If the principal of least privilege is applied, the number of 
users granted these permissions should be small. Note that permissions can also be granted via Azure AD groups and monitoring of these 
should also be conducted.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to AzureFirewall","Scheduled","0b904747-1336-4363-8d84-df2710bfe5e7","Identifies a match in AzureFirewall (NetworkRule & ApplicationRule Logs) from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureFirewall","Every 1 hour","Last 14 days","",,"Available"
" ","High","Correlate Unfamiliar sign-in properties and atypical travel alerts","Scheduled","a3df4a32-4805-4c6d-8699-f3c888af2f67","The combination of an Unfamiliar sign-in properties alert and an Atypical travel alert about the same user within a +10m or -10m window is considered a high severity incident.","AzureActiveDirectoryIdentityProtection","Every 1 day","Last 1 day","",,"Available"
" ","High","Known ZINC related maldoc hash","Scheduled","3174a9ec-d0ad-4152-8307-94ed04fa450a","Document hash used by ZINC in highly targeted spear phishing campaign.","CiscoASA|PaloAltoNetworks|SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Cisco Umbrella - Empty User Agent Detected","Scheduled","2b328487-162d-4034-b472-59f1d53684a1","Rule helps to detect empty and unusual user agent indicating web browsing activity by an unusual process other than a web browser.","CiscoUmbrellaDataConnector","Every 15 minutes","Last 15 minutes","",,"Available"
" ","High","Azure DevOps Agent Pool Created Then Deleted","Scheduled","acfdee3f-b794-404a-aeba-ef6a1fa08ad1","As well as adding build agents to an existing pool to execute malicious activity within a pipeline, an attacker could create a complete new agent pool and use this for execution.
Azure DevOps allows for the creation of agent pools with Azure hosted infrastructure or self-hosted infrastructure. Given the additional customizability of self-hosted agents this 
detection focuses on the creation of new self-hosted pools. To further reduce false positive rates the detection looks for pools created and deleted relatively quickly (within 7 days by default), 
as an attacker is likely to remove a malicious pool once used in order to reduce/remove evidence of their activity.","","Every 7 days","Last 14 days","",,"Available"
" ","Low","Suspicious application consent for offline access","Scheduled","3533f74c-9207-4047-96e2-0eb9383be587","This will alert when a user consents to provide a previously-unknown Azure application with offline access via OAuth.
Offline access will provide the Azure App with access to the listed resources without requiring two-factor authentication.
Consent to applications with offline access and read capabilities should be rare, especially as the knownApplications list is expanded. Public contributions to expand this filter are welcome!
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 day","Last 14 days","",,"Available"
" ","High","Known CERIUM domains and hashes","Scheduled","c87fb346-ea3a-4c64-ba92-3dd383e0f0b5","CERIUM malicious webserver and hash values for maldocs and malware. 
 Matches domain name IOCs related to the CERIUM activity group with CommonSecurityLog, DnsEvents, and VMConnection dataTypes.","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map URL entity to SecurityAlert data","Scheduled","f30a47c1-65fb-42b1-a7f4-00941c12550b","Identifies a match in SecurityAlert data from any URL IOC from TI","MicrosoftCloudAppSecurity|AzureSecurityCenter|ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","Low","Cognni Incidents for Low Sensitivity Legal Information","Scheduled","8374ec0f-d857-4c17-b1e7-93d11800f8fb","Display incidents in which low sensitivity legal information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Informational","(Preview) Excessive Downloads via Palo Alto GlobalProtect","Anomaly","06107abb-1b68-4fdc-841b-8a1ff9301467","This algorithm detects unusually high volume of download per user account via Palo Alto VPN solution.
The model is trained on the previous 14 days of the VPN logs.
It indicates anomalous high volume of  downloads in the last day.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Medium","A host is potentially running a crypto miner (ASIM Web Session schema)","Scheduled","8cbc3215-fa58-4bd6-aaaa-f0029c351730","This rule identifies a web request with a user agent header known to belong to a crypto miner. This indicates a crypto miner may have infected the client machine.<br>You can add custom crypto mining indicating User-Agent headers using a watchlist, for more information refer to the [UnusualUserAgents Watchlist](https://aka.ms/ASimUnusualUserAgentsWatchlist).<br><br>This rule uses the Advanced SIEM Information Model (ASIM) and supports any web session source that complies with ASIM. To use this Analytics Rule, deploy the [Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM).","","Every 15 minutes","Last 15 minutes","",,"Available"
" ","Medium","TI map Domain entity to SecurityAlert","Scheduled","87890d78-3e05-43ec-9ab9-ba32f4e01250","Identifies a match in SecurityAlert table from any Domain IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|MicrosoftCloudAppSecurity|AzureSecurityCenter","Every 1 hour","Last 14 days","",,"Available"
" ","Low","Palo Alto - possible internal to external port scanning","Scheduled","5b72f527-e3f6-4a00-9908-8e4fee14da9f","Identifies a list of internal Source IPs (10.x.x.x Hosts) that have triggered 10 or more non-graceful tcp server resets from one or more Destination IPs which 
results in an """"ApplicationProtocol = incomplete"""" designation. The server resets coupled with an """"Incomplete"""" ApplicationProtocol designation can be an indication 
of internal to external port scanning or probing attack. 
References: https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClUvCAK and
https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClTaCAK","PaloAltoNetworks","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","RDP Nesting","Scheduled","69a45b05-71f5-45ca-8944-2e038747fb39","Identifies when an RDP connection is made to a first system and then an RDP connection is made from the first system
to another system with the same account within the 60 minutes. Additionally, if historically daily
RDP connections are indicated by the logged EventID 4624 with LogonType = 10","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 8 days","",,"Available"
" ","Informational","(Preview) Suspicious volume of logins to computer with elevated token","Anomaly","9c27cee8-0a33-4abe-8683-212c0a98fc28","This algorithm detects an unusually high volume of successful logins with elevated token per computer. The model is trained on the previous 21 days of security event ID 4624 on a computer. It indicates anomalous high volume of successful logins with administrator privileges in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","Low","Web sites blocked by Eset","Scheduled","84ad2f8a-b64c-49bc-b669-bdb4fd3071e9","Create alert on web sites blocked by Eset.","EsetSMC","Every 5 minutes","Last 5 minutes","",,"Available"
" ","Low","Failed login attempts to Azure Portal","Scheduled","223db5c1-1bf8-47d8-8806-bed401b356a4","Identifies failed login attempts in the Azure Active Directory SigninLogs to the Azure Portal.  Many failed logon 
attempts or some failed logon attempts from multiple IPs could indicate a potential brute force attack.  
The following are excluded due to success and non-failure results:
References: https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes
0 - successful logon
50125 - Sign-in was interrupted due to a password reset or password registration entry.
50140 - This error occurred due to 'Keep me signed in' interrupt when the user was signing-in.","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 7 days","",,"Available"
" ","Medium","Failed host logons but success logon to AzureAD","Scheduled","1ce5e766-26ab-4616-b7c8-3b33ae321e80","Identifies a list of IP addresses with a minimum number(default of 5) of failed logon attempts to remote hosts.
Uses that list to identify any successful logons to Azure Active Directory from these IPs within the same timeframe.","AzureActiveDirectory|AzureActiveDirectory|SecurityEvents|Syslog","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Login from an unusual region via Palo Alto GlobalProtect account logins","Anomaly","8546330c-e1fb-422a-9388-5c09e9a8f4ca","When a Palo Alto GlobalProtect account logs in from a source region that has rarely been logged in
from during the last 14 days, an anomaly is triggered. This anomaly may indicate that the account
has been compromised.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","Medium","Azure DevOps Service Connection Abuse","Scheduled","d564ff12-8f53-41b8-8649-44f76b37b99f","Flags builds/releases that use a large number of service connections if they aren't manually in the allow list.
This is to determine if someone is hijacking a build/release and adding many service connections in order to abuse 
or dump credentials from service connections.","","Every 1 day","Last 14 days","",,"Available"
" ","Medium","SUNSPOT log file creation","Scheduled","c0e84221-f240-4dd7-ab1e-37e034ea2a4e","This query uses Microsoft Defender for Endpoint data and Windows Event Logs to look for IoCs associated with the SUNSPOT malware shared by Crowdstrike.
More details: 
  - https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/ 
  - https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-your-software-build-process-with-azure-sentinel/ba-p/2140807","MicrosoftThreatProtection|SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Anomalous scanning activity","Anomaly","2bb167bf-3951-435b-a932-8b03bfde0a2b","The Scanning Activity anomaly is looking to determine if there is potential port scanning anomaly in an environment coming from a single source IP to one or more destination IPs.  
The algorithm takes into account whether the IP is public, meaning external, or private, meaning internal, and the event is marked accordingly. Only private to public or public 
to private is considered at this time. Scanning activity can indicate an attacker attempting to determine available services in an environment that can be potentially 
exploited and used for ingress or lateral movement.
A high number of source ports and high number of destination ports from a single source IP to either a single or multiple destination IP or IPs can be interesting and indicate 
anomalous scanning. Additionally, if there is a high ratio of destination IPs to the single source IP this can indicate anomalous scanning.
Configuration details -
Job run default is daily, with hourly bins
The algorithm uses the following defaults to limit the results based on hourly bins, each is configurable
-> Included device actions - accept, allow, start
-> Excluded ports - 53, 67, 80, 8080, 123, 137, 138, 443, 445, 3389
-> Distinct destination port count >= 600
-> Distinct source port count >= 600
-> Distinct source port count divided by distinct destination port, ratio converted to percent >= 99.99
-> Source IP (always 1) divided by destination IP, ratio converted to percent >= 99.99","PaloAltoNetworks|Zscaler|CEF|CheckPoint|Fortinet","","","Every 1 day",,"Available"
" ","High","Privileged Accounts - Sign in Failure Spikes","Scheduled","34c5aff9-a8c2-4601-9654-c7e46342d03b"," Identifies spike in failed sign-ins from Privileged accounts. Privileged accounts list can be based on IdentityInfo UEBA table or built-in watchlist.
Spike is determined based on Time series anomaly which will look at historical baseline values.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to AWSCloudTrail","Scheduled","f110287e-1358-490d-8147-ed804b328514","Identifies a match in AWSCloudTrail from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AWS","Every 1 hour","Last 14 days","",,"Available"
" ","Informational","(Preview) Attempted user account bruteforce per logon type","Anomaly","c097bfdb-8b4b-4a98-b74d-1871ffd50a03","This algorithm detects an unusually high volume of failed login attempts per user account per logon type. The model is trained on the previous 21 days of security event ID 4625 on an account and a logon type. It indicates anomalous high volume of failed login attempts with certain logon type in the last day.","SecurityEvents","","","Every 1 day",,"Available"
" ","High","User Login from Different Countries within 3 hours","Scheduled","2954d424-f786-4677-9ffc-c24c44c6e7d5","This query searches for successful user logins to the Okta Console from different countries within 3 hours","OktaSSO","Every 3 hours","Last 3 hours","",,"Available"
" ","Medium","External Upstream Source Added to Azure DevOps Feed","Scheduled","adc32a33-1cd6-46f5-8801-e3ed8337885f","The detection looks for new external sources added to an Azure DevOps feed. An allow list can be customized to explicitly allow known good sources. 
An attacker could look to add a malicious feed in order to inject malicious packages into a build pipeline.","","Every 1 day","Last 1 day","",,"Available"
" ","Low","Suspicious Service Principal creation activity","Scheduled","6852d9da-8015-4b95-8ecf-d9572ee0395d","This alert will detect creation of an SPN, permissions granted, credentials cretaed, activity and deletion of the SPN in a time frame (default 10 minutes)","AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","TI map IP entity to SigninLogs","Scheduled","f2eb15bd-8a88-4b24-9281-e133edfba315","Identifies a match in SigninLogs from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureActiveDirectory|AzureActiveDirectory","Every 1 hour","Last 14 days","",,"Available"
" ","High","Vectra AI Detect - Suspected Compromised Host","Scheduled","60eb6cf0-3fa1-44c1-b1fe-220fbee23d63","Create an incident when a Host is suspected to be compromised. 
The higher the severity level is, the more immediate attention it requires as Vectra AI engine is more confident that this is a real threat. 
Level of severity are: Low, Medium, High, Critical). Recommended configuration is to trigger an alert for at least High and Critical.","AIVectraDetect","Every 1 hour","Last 1 hour","",,"Available"
" ","Informational","(Preview) Multi-region logins in a single day via Palo Alto GlobalProtect","Anomaly","03401f05-5c45-4f2d-9295-092764090e02","This algorithm detects a user account which had logins from multiple non-adjacent regions in a single day via Palo Alto VPN.","PaloAltoNetworks","","","Every 1 day",,"Available"
" ","High","Known STRONTIUM group domains - July 2019","Scheduled","074ce265-f684-41cd-af07-613c5f3e6d0d","Matches domain name IOCs related to Strontium group activity published July 2019 with CommonSecurityLog, DnsEvents and VMConnection dataTypes.
References: https://blogs.microsoft.com/on-the-issues/2019/07/17/new-cyberthreats-require-new-ways-to-protect-democracy/.","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ",,"Create incidents based on Microsoft Cloud App Security alerts","MicrosoftSecurityIncidentCreation","b3cfc7c0-092c-481c-a55b-34a3979758cb","Create incidents based on all alerts generated in Microsoft Cloud App Security","MicrosoftCloudAppSecurity","","","",,"Available"
" ","Low","Cognni Incidents for Low Sensitivity Financial Information","Scheduled","77171efa-4502-4ab7-9d23-d12305ff5a5e","Display incidents in which low sensitivity financial information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Low","Multiple Teams deleted by a single user","Scheduled","173f8699-6af5-484a-8b06-8c47ba89b380","This detection flags the occurrences of deleting multiple teams within an hour.
This data is a part of Office 365 Connector in Microsoft Sentinel.","Office365","Every 1 day","Last 1 day","",,"Available"
" ","Low","User account added to built in domain local or global group","Scheduled","a35f2c18-1b97-458f-ad26-e033af18eb99","Identifies when a user account has been added to a privileged built in domain local group or global group 
such as the Enterprise Admins, Cert Publishers or DnsAdmins. Be sure to verify this is an expected addition.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","SUNBURST suspicious SolarWinds child processes (Normalized Process Events)","Scheduled","631d02df-ab51-46c1-8d72-32d0cfec0720","Identifies suspicious child processes of SolarWinds.Orion.Core.BusinessLayer.dll that may be evidence of the SUNBURST backdoor
References:
- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelProcessEvent)","","Every 1 day","Last 1 day","",,"Available"
" ","Low","Changes to AWS Security Group ingress and egress settings","Scheduled","4f19d4e3-ec5f-4abc-9e61-819eb131758c","A Security Group acts as a virtual firewall of an instance to control inbound and outbound traffic. 
 Hence, ingress and egress settings changes to AWS Security Group should be monitored as these can expose the enviornment to new attack vectors.
More information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255.","AWS","Every 1 day","Last 1 day","",,"Available"
" ","Medium","(Preview) Anomalous RDP Login Detections","MLBehaviorAnalytics","737a2ce1-70a3-4968-9e90-3e6aca836abf","This detection uses machine learning (ML) to identify anomalous Remote Desktop Protocol (RDP) login activity, based on Windows Security Event data. Scenarios include:

*	Unusual IP - This IP address has not or has rarely been seen in last 30 days.
*	Unusual Geo - The IP address, city, country and ASN have not (or rarely) been seen in last 30 days.
*	New user - A new user logs in from an IP address and geo location, both or either of which are not expected to be seen in the last 30 days.

Allow 7 days after this alert is enabled for Microsoft Sentinel to build a profile of normal activity for your environment.	

This detection requires a specific configuration of the data source. [Learn more](https://docs.microsoft.com/en-us/azure/sentinel/connect-windows-security-events)

By enabling this rule, you give Microsoft permission to copy ingested data outside of your Microsoft Sentinel workspace's geography as necessary for processing by the machine learning engine.","SecurityEvents","","","",,"Available"
" ","Medium","TI map IP entity to VMConnection","Scheduled","9713e3c0-1410-468d-b79e-383448434b2d","Identifies a match in VMConnection from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureMonitor(VMInsights)","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","High count of failed attempts from same client IP","Scheduled","19e01883-15d8-4eb6-a7a5-3276cd668388","Identifies when 20 or more failed attempts from a given client IP in 1 minute occur on the IIS server.
This could be indicative of an attempted brute force. This could also simply indicate a misconfigured service or device.
Recommendations: Validate that these are expected connections from the given Client IP.  If the client IP is not recognized, 
potentially block these connections at the edge device.
If these are expected connections, verify the credentials are properly configured on the system, service, application or device 
that is associated with the client IP.
References:
IIS status code mapping: https://support.microsoft.com/help/943891/the-http-status-code-in-iis-7-0-iis-7-5-and-iis-8-0
Win32 Status code mapping: https://msdn.microsoft.com/library/cc231199.aspx","AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","High","Solorigate Defender Detections","Scheduled","e70fa6e0-796a-4e85-9420-98b17b0bb749","Surfaces any Defender Alert for Solorigate Events. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as 
 Device group, ip, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for all the the Solarigate Defender alerts.","MicrosoftDefenderAdvancedThreatProtection|MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","High","Known PHOSPHORUS group domains/IP - October 2020","Scheduled","7249500f-3038-4b83-8549-9cd8dfa2d498","Matches IOCs related to PHOSPHORUS group activity published October 2020 with CommonSecurityLog, DnsEvents, OfficeActivity and VMConnection dataTypes.
References: ","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|Zscaler|Fortinet|OfficeATP|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","Low","Alsid Indicators of Attack","Scheduled","3caa67ef-8ed3-4ab5-baf2-3850d3667f3d","Searches for triggered Indicators of Attack","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Azure DevOps Pull Request Policy Bypassing - Historic allow list","Scheduled","4d8de9e6-263e-4845-8618-cd23a4f58b70","This detection builds an allow list of historic PR policy bypasses and compares to recent history, flagging pull request bypasses that are not manually in the allow list and not historically included in the allow list.","","Every 3 hours","Last 14 days","",,"Available"
" ",,"Create incidents based on Microsoft Defender for Office 365 alerts","MicrosoftSecurityIncidentCreation","ee1d718b-9ed9-4a71-90cd-a483a4f008df","Create incidents based on all alerts generated in Microsoft Defender for Office 365","OfficeATP","","","",,"Available"
" ","Medium","AWS Guard Duty Alert","Scheduled","bf0cde21-0c41-48f6-a40c-6b5bd71fa106","Amazon GuardDuty is a threat detection service that continuously monitors your AWS accounts and workloads for malicious activity and delivers detailed security findings for visibility and remediation. This templates create an alert for each Amazon GuardDuty finding.","AWSS3","Every 5 hours","Last 5 hours","",,"Available"
" ",,"Create incidents based on Azure Defender for IOT alerts","MicrosoftSecurityIncidentCreation","a2e0eb51-1f11-461a-999b-cd0ebe5c7a72","Create incidents based on all alerts generated in Azure Defender for IOT","IoT","","","",,"Available"
" ","High","Azure DevOps Personal Access Token (PAT) misuse","Scheduled","ac891683-53c3-4f86-86b4-c361708e2b2b","This Alert detects whenever a PAT is used in ways that PATs are not normally used.  May require an allow list and baselining.
Reference - https://docs.microsoft.com/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&tabs=preview-page
Use this query for baselining:
AzureDevOpsAuditing
| distinct OperationName","","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Vectra AI Detect - Suspicious Behaviors","Scheduled","6cb75f65-231f-46c4-a0b3-50ff21ee6ed3","Create an incident for each new malicious behavior detected by Vectra Detect. 
By default, it looks through all tactics. This can be modified to create incident only for a subset of tactics.","AIVectraDetect","Every 1 hour","Last 1 hour","",,"Available"
" ","Informational","(Preview) Anomalous Failed Sign-in","Anomaly","36f191f8-d1d1-4a22-8ba7-22c9b64a651a","Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts.
Sentinel UEBA detects anomalies based on dynamic baselines created for each entity across various data inputs. Each entityâ€™s baseline behavior is set according to its own historical activities, those of its peers, and those of the organization as a whole. Anomalies can be triggered by the correlation of different attributes such as action type, geo-location, device, resource, ISP, and more.
Supported data sources: Azure Sign-in, Windows security logs (Events 4624, 4625, 4672, 4648)","AzureActiveDirectory|SecurityEvents","","","Every 1 day",,"Available"
" ","Low","Multiple Password Reset by user","Scheduled","0b9ae89d-8cad-461c-808f-0494f70ad5c4","This query will determine multiple password resets by user across multiple data sources. 
Account manipulation including password reset may aid adversaries in maintaining access to credentials 
and certain permission levels within an environment.","AzureActiveDirectory|SecurityEvents|Syslog|Office365","Every 1 day","Last 1 day","",,"Available"
" ","High","Known Barium IP","Scheduled","6ee72a9e-2e54-459c-bc9a-9c09a6502a63","Identifies a match across various data feeds for IP IOCs related to the Barium activity group.  
 References: https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer' ","Office365|DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|SecurityEvents|AzureActiveDirectory|AzureActiveDirectory|AzureMonitor(WireData)|AzureMonitor(IIS)|AzureActivity|AWS|MicrosoftThreatProtection|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","Low","Potential beaconing activity (ASIM Network Session schema)","Scheduled","fcb9d75c-c3c1-4910-8697-f136bfef2363","This rule identifies beaconing patterns from Network traffic logs based on recurrent frequency patterns. Such potential outbound beaconing pattern to untrusted public networks should be investigated for any malware callbacks or data exfiltration attempts as discussed in this [Blog](http://www.austintaylor.io/detect/beaconing/intrusion/detection/system/command/control/flare/elastic/stack/2017/06/10/detect-beaconing-with-flare-elasticsearch-and-intrusion-detection-systems/).\<br><br>This rule uses the [Advanced SIEM Information Model (ASIM)](https://aka.ms/AboutASIM) and supports any network session source that compiles with ASIM. To use this Analytics Rule, [deploy the Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM).","","Every 1 day","Last 2 days","",,"Available"
" ","Low","DNS events related to ToR proxies","Scheduled","a83ef0f4-dace-4767-bce3-ebd32599d2a0","Identifies IP addresses performing DNS lookups associated with common ToR proxies.","DNS","Every 1 day","Last 1 day","",,"Available"
" ","Low","Fortinet - Beacon pattern detected","Scheduled","3255ec41-6bd6-4f35-84b1-c032b18bbfcb","Identifies patterns in the time deltas of contacts between internal and external IPs in Fortinet network data that are consistent with beaconing.
 Accounts for randomness (jitter) and seasonality such as working hours that may have been introduced into the beacon pattern.
 The lookback is set to 1d, the minimum granularity in time deltas is set to 60 seconds and the minimum number of beacons required to emit a
 detection is set to 4.
 Increase the lookback period to capture beacons with larger periodicities.
 The jitter tolerance is set to 0.2 - This means we account for an overall 20% deviation from the infered beacon periodicity. Seasonality is dealt with
 automatically using series_outliers.
 Note: In large environments it may be necessary to reduce the lookback period to get fast query times.","Fortinet","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Linked Malicious Storage Artifacts","Scheduled","b9e3b9f8-a406-4151-9891-e5ff1ddd8c1d","An IP address which uploaded malicious content to an Azure Blob or File Storage container (triggering a malware alert) also uploaded additional files.","MicrosoftCloudAppSecurity","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Fake computer account created","Scheduled","c1faf5e8-6958-11ec-90d6-0242ac120003","This query detects domain user accounts creation (event ID 4720) where the username ends with $. 
Accounts that end with $ are normally domain computer accounts and when they are created the event ID 4741 is generated instead.
Ref: https://blog.menasec.net/2019/02/threat-hunting-6-hiding-in-plain-sights.html","SecurityEvents","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","A client made a web request to a potentially harmful file (ASIM Web Session schema)","Scheduled","09c49590-4e9d-4da9-a34d-17222d0c9e7e","This rule identifies a web request to a URL that holds a file type, including .ps1, .bat, .vbs, and .scr that can be harmful if downloaded. This rule uses the [Advanced SIEM Information Model (ASIM)](https://aka.ms/AboutASIM) and supports any web session source that complies with ASIM. To use this Analytics Rule, deploy the Advanced SIEM information Model (ASIM).
To use this analytics rule, deploy the [Advanced SIEM information Model (ASIM)](https://aka.ms/DeployASIM)","","Every 10 minutes","Last 10 minutes","",,"Available"
" ","High","Non Domain Controller Active Directory Replication","Scheduled","b9d2eebc-5dcb-4888-8165-900db44443ab","This query detects potential attempts by non-computer accounts (non domain controllers) to retrieve/synchronize an active directory object leveraging directory replication services (DRS).
A Domain Controller (computer account) would usually be performing these actions in a domain environment. Another detection rule can be created to cover domain controllers accounts doing at rare times.
A domain user with privileged permissions to use directory replication services is rare. Ref: https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-180815210510.html","SecurityEvents","Every 1 day","Last 7 days","",,"Available"
" ","Medium","ProofpointPOD - Multiple protected emails to unknown recipient","Scheduled","f8127962-7739-4211-a4a9-390a7a00e91f","Detects when multiple protected messages where sent to early not seen recipient.","ProofpointPOD","Every 30 minutes","Last 30 minutes","",,"Available"
" ","Medium","Full Admin policy created and then attached to Roles, Users or Groups","Scheduled","826bb2f8-7894-4785-9a6b-a8a855d8366f","Identity and Access Management (IAM) securely manages access to AWS services and resources. 
Identifies when a policy is created with Full Administrators Access (Allow-Action:*,Resource:*). 
This policy can be attached to role,user or group and may be used by an adversary to escalate a normal user privileges to an adminsitrative level.
AWS IAM Policy Grammar: https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_grammar.html
and AWS IAM API at https://docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html","AWS","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Azure DevOps Pipeline modified by a new user.","Scheduled","155e9134-d5ad-4a6f-88f3-99c220040b66","There are several potential pipeline steps that could be modified by an attacker to inject malicious code into the build cycle. A likely attacker path is the modification to an existing pipeline that they have access to. 
This detection looks for users modifying a pipeline when they have not previously been observed modifying or creating that pipeline before. This query also joins events with data to Azure AD Identity Protection (AAD IdP) 
in order to show if the user conducting the action has any associated AAD IdP alerts. You can also choose to filter this detection to only alert when the user also has AAD IdP alerts associated with them.","","Every 1 day","Last 14 days","",,"Available"
" ","Medium","New access credential added to Application or Service Principal","Scheduled","79566f41-df67-4e10-a703-c38a6213afd8","This will alert when an admin or app owner account adds a new credential to an Application or Service Principal where a verify KeyCredential was already present for the app.
If a threat actor obtains access to an account with sufficient privileges and adds the alternate authentication material triggering this event, the threat actor can now authenticate as the Application or Service Principal using this credential.
Additional information on OAuth Credential Grants can be found in RFC 6749 Section 4.4 or https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow
For further information on AuditLogs please see https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities.","AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Cisco Umbrella - Request Allowed to harmful/malicious URI category","Scheduled","d6bf1931-b1eb-448d-90b2-de118559c7ce","It is reccomended that these Categories shoud be blocked by policies because they provide harmful/malicious content..","CiscoUmbrellaDataConnector","Every 10 minutes","Last 10 minutes","",,"Available"
" ",,"(Private Preview) Create incidents based on Microsoft 365 Insider Risk Management","MicrosoftSecurityIncidentCreation","c805d9b1-97e7-4bc0-9172-67edb36273e4","Create incidents based on all alerts generated in Microsoft 365 Insider Risk Management","OfficeIRM","","","",,"Available"
" ","High","Azure DevOps Audit Stream Disabled","Scheduled","4e8238bd-ff4f-4126-a9f6-09b3b6801b3d","Azure DevOps allow for audit logs to be streamed to external storage solutions such as SIEM solutions. An attacker looking to hide malicious Azure DevOps activity from defenders may look to disable data streams 
before conducting activity and then re-enabling the stream after (so as not to raise data threshold-based alarms). Looking for disabled audit streams can identify this activity, and due to the nature of the action 
its unlikely to have a high false positive rate.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Excessive Amount of Denied Connections from a Single Source","Scheduled","3d645a88-2724-41a7-adea-db74c439cf79","This creates an incident in the event that a single source IP address generates a excessive amount of denied connections.","SophosXGFirewall","Every 1 hour","Last 1 hour","",,"Available"
" ","Medium","Malformed user agent","Scheduled","a357535e-f722-4afe-b375-cff362b2b376","Malware authors will sometimes hardcode user agent string values when writing the network communication component of their malware.
Malformed user agents can be an indication of such malware.","WAF|Office365|AzureActiveDirectory|AzureActiveDirectory|AWS|AzureMonitor(IIS)","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Cisco Umbrella - URI contains IP address","Scheduled","ee1818ec-5f65-4991-b711-bcf2ab7e36c3","Malware can use IP address to communicate with C2.","CiscoUmbrellaDataConnector","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Low","Azure DevOps New Extension Added","Scheduled","bf07ca9c-e408-443a-8939-6860a45a929e","Extensions add additional features to Azure DevOps. An attacker could use a malicious extension to conduct malicious activity. 
This query looks for new extensions that are not from a configurable list of approved publishers.","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Azure DevOps Administrator Group Monitoring","Scheduled","89e6adbd-612c-4fbe-bc3d-32f81baf3b6c","This detection monitors for additions to projects or project collection administration groups in an Azure DevOps Organization.","","Every 4 hours","Last 4 hours","",,"Available"
" ","High","Bulk Changes to Privileged Account Permissions","Scheduled","218f60de-c269-457a-b882-9966632b9dc6","Identifies when changes to multiple users permissions are changed at once. Investigate immediately if not a planned change. This setting could enable an attacker access to Azure subscriptions in your environment.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-privileged-identity-management","AzureActiveDirectory","Every 2 hours","Last 2 hours","",,"Available"
" ","Medium","Cisco ASA - threat detection message fired","Scheduled","795edf2d-cf3e-45b5-8452-fe6c9e6a582e","Identifies when the Cisco ASA Threat Detection engine fired an alert based on malicious activity occurring on the network inicated by DeviceEventClassID 733101-733105
Resources: https://www.cisco.com/c/en/us/td/docs/security/asa/syslog/b_syslog/syslogs9.html
Details on how to further troubleshoot/investigate: https://www.cisco.com/c/en/us/support/docs/security/asa-5500-x-series-next-generation-firewalls/113685-asa-threat-detection.html","CiscoASA","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","User joining Zoom meeting from suspicious timezone","Scheduled","58fc0170-0877-4ea8-a9ff-d805e361cfae","The alert shows users that join a Zoom meeting from a time zone other than the one the meeting was created in.
You can also whitelist known good time zones in the tz_whitelist value using the tz database name format https://en.wikipedia.org/wiki/List_of_tz_database_time_zones","","Every 1 day","Last 14 days","",,"Available"
" ","Informational","(Preview) Unusual network volume anomaly","Anomaly","95514e77-1b23-4f05-817c-ae363c53aad3","This algorithm is to detect unusually high volume of connections in network logs. 
It uses time series to decompose the data into seasonal, trend and residual components to 
calculate baseline. Any sudden large deviation from the historical baseline is considered as anomalous activity.","PaloAltoNetworks|Zscaler|CEF|CheckPoint|Fortinet","","","Every 1 day",,"Available"
" ","Medium","AD FS Remote Auth Sync Connection","Scheduled","2f4165a6-c4fb-4e94-861e-37f1b4d6c0e6","This detection uses Security events from the """"AD FS Auditing"""" provider to detect suspicious authentication events on an AD FS server. The results then get
correlated with events from the Windows Filtering Platform (WFP) to detect suspicious incoming network traffic on port 80 on the AD FS server.
This could be a sign of a threat actor trying to use replication services on the AD FS server to get its configuration settings and extract
sensitive information such as AD FS certificates.
In order to use this query you need to enable AD FS auditing on the AD FS Server.
Reference: https://twitter.com/OTR_Community/status/1387038995016732672
","SecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","TI map IP entity to AzureActivity","Scheduled","2441bce9-02e4-407b-8cc7-7d597f38b8b0","Identifies a match in AzureActivity from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii|AzureActivity","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","SharePointFileOperation via previously unseen IPs","Scheduled","4b11568b-3f5f-4ba1-80c8-7f1dc8390eb7","Identifies when the volume of documents uploaded to or downloaded from Sharepoint by new IP addresses
exceeds a threshold (default is 50).","Office365","Every 1 day","Last 14 days","",,"Available"
" ","High","Create Incident for XDR Alerts (Critical & High)","Scheduled","0febd8cc-1b8d-45ed-87b3-e1e8a57d14cd","This Query creates an incident based on Trend Micro XDR Workbench Alerts and maps the impacted entities for Microsoft Sentinel usage. (Critical & High Serverity Alerts)","TrendMicroXDR","Every 1 hour","Last 1 hour","",,"Available"
" ","Low","Azure Active Directory PowerShell accessing non-AAD resources","Scheduled","50574fac-f8d1-4395-81c7-78a463ff0c52","This will alert when a user or application signs in using Azure Active Directory PowerShell to access non-Active Directory resources, such as the Azure Key Vault, which may be undesired or unauthorized behavior.
For capabilities and expected behavior of the Azure Active Directory PowerShell module, see: https://docs.microsoft.com/powershell/module/azuread/?view=azureadps-2.0.
For further information on Azure Active Directory Signin activity reports, see: https://docs.microsoft.com/azure/active-directory/reports-monitoring/concept-sign-ins.","AzureActiveDirectory|AzureActiveDirectory","Every 1 hour","Last 1 hour","",,"Available"
" ","High","Account Created and Deleted in Short Timeframe","Scheduled","bb616d82-108f-47d3-9dec-9652ea0d3bf6","Search for user principal name (UPN) events. Look for accounts created and then deleted in under 24 hours. Attackers may create an account for their use, and then remove the account when no longer needed.
Ref : https://docs.microsoft.com/azure/active-directory/fundamentals/security-operations-user-accounts#short-lived-account","AzureActiveDirectory","Every 1 hour","Last 1 day","",,"Available"
" ","Low","DNS events related to mining pools","Scheduled","0d76e9cf-788d-4a69-ac7d-f234826b5bed","Identifies IP addresses that may be performing DNS lookups associated with common currency mining pools.","DNS","Every 1 day","Last 1 day","",,"Available"
" ","Medium","OMI Vulnerability Exploitation","Scheduled","3cc5ccd8-b416-4141-bb2d-4eba370e37a5","Following the September 14th, 2021 release of three Elevation of Privilege
(EoP) vulnerabilities (CVE-2021-38645, CVE-2021-38649, CVE-2021-38648) and one
unauthenticated Remote Code Execution (RCE) vulnerability (CVE-2021-38647) in
the Open Management Infrastructure (OMI) Framework.
This detection validates that any OMS-agent that is reporting to the Microsoft
Sentinel workspace is updated with the patch. The detection will go over the
heartbeats received from all agents over the last day and will create alert
for those agents who are not updated.","","Every 1 day","Last 1 day","",,"Available"
" ","Low","Alsid Active Directory attacks pathways","Scheduled","9649e203-3cb7-47ff-89a9-42f2a5eefe31","Searches for triggered Indicators of Exposures related to Active Directory attacks pathways","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Low","Attempt to bypass conditional access rule in Azure AD","Scheduled","3af9285d-bb98-4a35-ad29-5ea39ba0c628","Identifies an attempt to Bypass conditional access rule(s) in Azure Active Directory.
The ConditionalAccessStatus column value details if there was an attempt to bypass Conditional Access
or if the Conditional access rule was not satisfied (ConditionalAccessStatus == 1).
References: 
https://docs.microsoft.com/azure/active-directory/conditional-access/overview
https://docs.microsoft.com/azure/active-directory/reports-monitoring/concept-sign-ins
https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes
ConditionalAccessStatus == 0 // Success
ConditionalAccessStatus == 1 // Failure
ConditionalAccessStatus == 2 // Not Applied
ConditionalAccessStatus == 3 // unknown","AzureActiveDirectory|AzureActiveDirectory","Every 1 day","Last 1 day","",,"Available"
" ","High","Known Barium domains","Scheduled","70b12a3b-4899-42cb-910c-5ffaf9d7997d","Identifies a match across various data feeds for domains IOCs related to the Barium activity group.
 References: https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer","DNS|AzureMonitor(VMInsights)|CiscoASA|PaloAltoNetworks|MicrosoftThreatProtection|AzureFirewall","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Process execution frequency anomaly","Scheduled","2c55fe7a-b06f-4029-a5b9-c54a2320d7b8","Identifies anomalous spike in frequency of executions of sensitive processes which are often leveraged as attack vectors.
The query leverages KQL built-in anomaly detection algorithms to find large deviations from baseline patterns.
Sudden increases in execution frequency of sensitive processes should be further investigated for malicious activity.
Tune the values from 1.5 to 3 in series_decompose_anomalies for further outliers or based on custom threshold values for score.","SecurityEvents|WindowsSecurityEvents","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","SUNBURST network beacons","Scheduled","ce1e7025-866c-41f3-9b08-ec170e05e73e","Identifies SolarWinds SUNBURST domain beacon IOCs in DeviceNetworkEvents
References:
- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f","MicrosoftThreatProtection","Every 1 day","Last 1 day","",,"Available"
" ","Medium","Time series anomaly detection for total volume of traffic","Scheduled","06a9b845-6a95-4432-a78b-83919b28c375","Identifies anamalous spikes in network traffic logs as compared to baseline or normal historical patterns.
The query leverages a KQL built-in anomaly detection algorithm to find large deviations from baseline patterns.
Sudden increases in network traffic volume may be an indication of data exfiltration attempts and should be investigated.
The higher the score, the further it is from the baseline value.
The output is aggregated to provide summary view of unique source IP to destination IP address and port traffic observed in the flagged anomaly hour.
The source IP addresses which were sending less than percentotalthreshold of the total traffic have been exluded whose value can be adjusted as needed .
You may have to run queries for individual source IP addresses from SourceIPlist to determine if anything looks suspicious","Barracuda|CEF|CheckPoint|CiscoASA|F5|Fortinet|PaloAltoNetworks","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Multiple users email forwarded to same destination","Scheduled","871ba14c-88ef-48aa-ad38-810f26760ca3","Identifies when multiple (more than one) users mailboxes are configured to forward to the same destination. 
This could be an attacker-controlled destination mailbox configured to collect mail from multiple compromised user accounts.","Office365","Every 1 day","Last 7 days","",,"Available"
" ","Medium","ProofpointPOD - Possible data exfiltration to private email","Scheduled","aedc5b33-2d7c-42cb-a692-f25ef637cbb1","Detects when sender sent email to the non-corporate domain and recipient's username is the same as sender's username.","ProofpointPOD","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Medium","TI map URL entity to OfficeActivity data","Scheduled","36a9c9e5-3dc1-4ed9-afaa-1d13617bfc2b","Identifies a match in OfficeActivity data from any URL IOC from TI","Office365|ThreatIntelligence","Every 1 hour","Last 14 days","",,"Available"
" ","Medium","Security Event log cleared","Scheduled","80da0a8f-cfe1-4cd0-a895-8bc1771a720e","Checks for event id 1102 which indicates the security event log was cleared. 
It uses Event Source Name """"Microsoft-Windows-Eventlog"""" to avoid generating false positives from other sources, like AD FS servers for instance.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Medium","PulseConnectSecure - Large Number of Distinct Failed User Logins","Scheduled","1fa1528e-f746-4794-8a41-14827f4cb798","This query identifies evidence of failed login attempts from a large number of distinct users on a Pulse Connect Secure VPN server","PulseConnectSecure","Every 1 hour","Last 1 hour","",,"Available"
" ","High","SOURGUM Actor IOC - July 2021","Scheduled","94749332-1ad9-49dd-a5ab-5ff2170788fc","Identifies a match across IOC's related to an actor tracked by Microsoft as SOURGUM","DNS|AzureMonitor(VMInsights)|F5|CiscoASA|PaloAltoNetworks|Fortinet|CheckPoint|CEF|MicrosoftThreatProtection|SecurityEvents|Office365|AzureFirewall|WindowsFirewall","Every 6 hours","Last 6 hours","",,"Available"
" ","High","DEV-0586 Actor IOC - January 2022","Scheduled","961b6a81-5c53-40b6-9800-4f661a8faea7","Identifies a match across IOC's related to an actor tracked by Microsoft as DEV-0586
 Refrence: https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/","CiscoASA|PaloAltoNetworks|MicrosoftThreatProtection|SecurityEvents|WindowsSecurityEvents","Every 6 hours","Last 6 hours","",,"Available"
" ","Medium","Brute force attack against user credentials (Uses Authentication Normalization)","Scheduled","a6c435a2-b1a0-466d-b730-9f8af69262e8","Identifies evidence of brute force activity against a user highlighting multiple authentication failures 
and by a successful authentication within a given time window. 
(The query does not enforce any sequence - eg requiring the successful authentication to occur last.)
Default Failure count is 10, Default Success count is 1 and default Time Window is 20 minutes.
To use this analytics rule, make sure you have deployed the [ASIM normalization parsers](https://aka.ms/AzSentinelAuthentication)","","Every 1 hour","Last 1 hour","",,"Available"
" ","Informational","(Preview) Anomalous W3CIIS logs activity","Anomaly","8a12afde-ed27-46ac-a5ef-392e3d4f071f","This anomaly indicates anomalous W3CIIS sessions within the last day, due to reasons such as a high number of distinct uri queries, specific http verbs or http statuses, user agents, or an unusually high number of logs in a session.
The machine learning algorithm identifies unusual W3CIIS log events within an hourly session, grouped by site name and client IP.
The model is trained on the previous 7 days of W3CIIS activity, using an autoencoder. The algorithm checks for sufficient volume of W3CIIS activity before training the model.
The autoencoder compressess these site name/client IP sessions using a bottleneck encoding, and reconstructs the input sessions using a decoder.
Sessions with high reconstruction errors are marked as anomalous.","AzureMonitor(IIS)","","","Every 1 day",,"Available"
" ","Medium","TI map IP entity to AppServiceHTTPLogs","Scheduled","f9949656-473f-4503-bf43-a9d9890f7d08","Identifies a match in AppServiceHTTPLogs from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 14 days","",,"Available"
" ","High","Alsid Golden Ticket","Scheduled","21ab3f52-6d79-47e3-97f8-ad65f2cb29fb","Searches for Golden Ticket attacks","AlsidForAD","Every 2 hours","Last 2 hours","",,"Available"
" ","Low","Failed logon attempts by valid accounts within 10 mins","Scheduled","0777f138-e5d8-4eab-bec1-e11ddfbc2be2","Identifies when failed logon attempts are 20 or higher during a 10 minute period (2 failed logons per minute minimum) from valid account.","SecurityEvents|WindowsSecurityEvents","Every 10 minutes","Last 10 minutes","",,"Available"
" ","Medium","Suspicious granting of permissions to an account","Scheduled","b2c15736-b9eb-4dae-8b02-3016b6a45a32","Identifies IPs from which users grant access to other users on azure resources and alerts when a previously unseen source IP address is used.","AzureActivity","Every 1 day","Last 14 days","",,"Available"
" ","Low","Wazuh - Large Number of Web errors from an IP","Scheduled","2790795b-7dba-483e-853f-44aa0bc9c985","Identifies instances where Wazuh logged over 400 '403' Web Errors from one IP Address. To onboard Wazuh data into Sentinel please view: https://github.com/wazuh/wazuh-documentation/blob/master/source/azure/monitoring%20activity.rst","","Every 1 day","Last 1 day","",,"Available"
" ","Medium","New Agent Added to Pool by New User or Added to a New OS Type.","Scheduled","4ce177b3-56b1-4f0e-b83e-27eed4cb0b16","As seen in attacks such as SolarWinds attackers can look to subvert a build process by controlling build servers. Azure DevOps uses agent pools to execute pipeline tasks. 
An attacker could insert compromised agents that they control into the pools in order to execute malicious code. This query looks for users adding agents to pools they have 
not added agents to before, or adding agents to a pool of an OS that has not been added to that pool before. This detection has potential for false positives so has a 
configurable allow list to allow for certain users to be excluded from the logic.","","Every 1 day","Last 14 days","",,"Available"
" ","Medium","Base64 encoded Windows process command-lines","Scheduled","ca67c83e-7fff-4127-a3e3-1af66d6d4cad","Identifies instances of a base64 encoded PE file header seen in the process command line parameter.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 1 day","",,"Available"
" ","Informational","(Preview) Potential data staging","Anomaly","af7fd11a-f305-44e1-8f46-f31580a15eab","The algorithm compares the downloads of distinct files on a per user basis from the previous week with the downloads for the current day for each user and 
an anomaly is triggered when the number of downloads of distinct files exceeds the configured number of standard deviations above the mean. 
Currently the algorithm only analyze commonly seen files during exfiltration of type documents, images, videos and archives with the extensions
[""""doc"""",""""docx"""",""""xls"""",""""xlsx"""",""""xlsm"""",""""ppt"""",""""pptx"""",""""one"""",""""pdf"""",""""zip"""",""""rar"""",""""bmp"""",""""jpg"""",""""mp3"""",""""mp4"""",""""mov""""].","Office365","","","Every 1 day",,"Available"
" ","High","Vulnerable Machines related to log4j CVE-2021-44228","Scheduled","3d71fc38-f249-454e-8479-0a358382ef9a","This query uses the Azure Defender Security Nested Recommendations data to find machines vulnerable to log4j CVE-2021-44228. Log4j is an open-source Apache logging library that is used in 
 many Java-based applications. Security Nested Recommendations data is sent to Microsoft Sentinel using the continuous export feature of Azure Defender(refrence link below).
 Reference: https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/
 Reference: https://docs.microsoft.com/azure/security-center/continuous-export?tabs=azure-portal
 Reference: https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/how-defender-for-cloud-displays-machines-affected-by-log4j/ba-p/3037271","","Every 1 day","Last 1 day","",,"Available"
" ","Low","New UserAgent observed in last 24 hours","Scheduled","b725d62c-eb77-42ff-96f6-bdc6745fc6e0","Identifies new UserAgents observed in the last 24 hours versus the previous 14 days. This detection
extracts words from user agents to build the baseline and determine rareity rather than perform a
direct comparison. This avoids FPs caused by version numbers and other high entropy user agent components.
These new UserAgents could be benign. However, in normally stable environments,
these new UserAgents could provide a starting point for investigating malicious activity.
Note: W3CIISLog can be noisy depending on the environment, however OfficeActivity and AWSCloudTrail are
usually stable with low numbers of detections.","AWS|Office365|AzureMonitor(IIS)","Every 1 day","Last 14 days","",,"Available"
" ","Informational","(Preview) Excessive data transfer anomaly","Anomaly","23850aa1-37d3-4b4b-9f39-4ebf5feb59fd","This algorithm is to detect unusually high data transfer seen in network logs. 
It uses time series to decompose the data into seasonal, trend and residual components to 
calculate baseline. Any sudden large deviation from the historical baseline is considered anomalous activity.","PaloAltoNetworks|Zscaler|CEF|CheckPoint|Fortinet","","","Every 1 day",,"Available"
" ","Medium","Suspicious number of resource creation or deployment activities","Scheduled","361dd1e3-1c11-491e-82a3-bb2e44ac36ba","Indicates when an anomalous number of VM creations or deployment activities occur in Azure via the AzureActivity log.
The anomaly detection identifies activities that have occurred both since the start of the day 1 day ago and the start of the day 7 days ago.
The start of the day is considered 12am UTC time.","AzureActivity","Every 1 day","Last 7 days","",,"Available"
" ","Medium","Cognni Incidents for Medium Sensitivity Legal Information","Scheduled","db750607-d48f-4aef-b238-085f4a9882f1","Display incidents in which medium sensitivity legal information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Medium","Cisco Umbrella - Rare User Agent Detected","Scheduled","8c8de3fa-6425-4623-9cd9-45de1dd0569a","Rule helps to detect a rare user-agents indicating web browsing activity by an unusual process other than a web browser.","CiscoUmbrellaDataConnector","Every 1 day","Last 14 days","",,"Available"
" ","Informational","(Preview) Anomalous Code Execution","Anomaly","8595d264-2f64-442d-b293-4e16dffc9882","Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.
These interfaces and languages provide ways of interacting with computer systems
and are a common feature across many different platforms.","AzureActivity","","","Every 1 day",,"Available"
" ","Medium","Microsoft COVID-19 file hash indicator matches","Scheduled","2be4ef67-a93f-4d8a-981a-88158cb73abd","Identifies a match in CommonSecurityLog Event data from any FileHash published in the Microsoft COVID-19 Threat Intel Feed - as described at https://www.microsoft.com/security/blog/2020/05/14/open-sourcing-covid-threat-intelligence/","PaloAltoNetworks","Every 1 hour","Last 14 days","",,"Available"
" ","High","Cognni Incidents for Highly Sensitive HR Information","Scheduled","f68846cf-ec99-497d-9ce1-80a9441564fb","Display incidents in which highly sensitive HR information was placed at risk by user sharing.","CognniSentinelDataConnector","Every 5 hours","Last 5 hours","",,"Available"
" ","Low","Excessive Windows logon failures","Scheduled","2391ce61-8c8d-41ac-9723-d945b2e90720","User has over 50 Windows logon failures today and at least 33% of the count of logon failures over the previous 7 days.","SecurityEvents|WindowsSecurityEvents","Every 1 day","Last 8 days","",,"Available"
" ","Medium","TI map IP entity to GitHub_CL","Scheduled","aac495a9-feb1-446d-b08e-a1164a539452","Identifies a match in GitHub_CL table from any IP IOC from TI","ThreatIntelligence|ThreatIntelligenceTaxii","Every 1 hour","Last 1 day","",,"Available"
" ","Low","Accessed files shared by temporary external user","Scheduled","bff058b2-500e-4ae5-bb49-a5b1423cbd5b","This detection identifies an external user is added to a Team or Teams chat
and shares a files which is accessed by many users (>10) and the users is removed within short period of time. This might be
an indicator of suspicious activity.","Office365","Every 1 hour","Last 1 hour","",,"Available"
